
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for Python package 'corgy'.">
      
      
        <meta name="author" content="Jayanth Koushik">
      
      
        <link rel="canonical" href="https://jkoushik.me/corgy/latest/usage/corgy.html">
      
      
        <link rel="prev" href="../index.html">
      
      
        <link rel="next" href="corgy.types.html">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>corgy - corgy</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#corgy.Corgy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="corgy" class="md-header__button md-logo" aria-label="corgy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m19 3-4 4 3 3 1-1 1 1 2-2-3-3V3M3 7 2 8l3 3v3l-1 1v6h2v-3l2-3h7v6h2V11l-3-3-1 1H5L3 7Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            corgy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              corgy
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/jayanthkoushik/corgy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="corgy" class="md-nav__button md-logo" aria-label="corgy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m19 3-4 4 3 3 1-1 1 1 2-2-3-3V3M3 7 2 8l3 3v3l-1 1v6h2v-3l2-3h7v6h2V11l-3-3-1 1H5L3 7Z"/></svg>

    </a>
    corgy
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jayanthkoushik/corgy" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          corgy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="corgy.html" class="md-nav__link md-nav__link--active">
        corgy
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#corgy.Corgy" class="md-nav__link">
    Corgy
  </a>
  
    <nav class="md-nav" aria-label="Corgy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.add_args_to_parser" class="md-nav__link">
    add_args_to_parser()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.as_dict" class="md-nav__link">
    as_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.attrs" class="md-nav__link">
    attrs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.freeze" class="md-nav__link">
    freeze()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.from_dict" class="md-nav__link">
    from_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.load_dict" class="md-nav__link">
    load_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.parse_from_cmdline" class="md-nav__link">
    parse_from_cmdline()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.parse_from_toml" class="md-nav__link">
    parse_from_toml()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#corgy.corgyparser" class="md-nav__link">
    corgyparser()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#corgy.corgychecker" class="md-nav__link">
    corgychecker()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="corgy.types.html" class="md-nav__link">
        corgy.types
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#corgy.Corgy" class="md-nav__link">
    Corgy
  </a>
  
    <nav class="md-nav" aria-label="Corgy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.add_args_to_parser" class="md-nav__link">
    add_args_to_parser()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.as_dict" class="md-nav__link">
    as_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.attrs" class="md-nav__link">
    attrs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.freeze" class="md-nav__link">
    freeze()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.from_dict" class="md-nav__link">
    from_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.load_dict" class="md-nav__link">
    load_dict()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.parse_from_cmdline" class="md-nav__link">
    parse_from_cmdline()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#corgy._corgy.Corgy.parse_from_toml" class="md-nav__link">
    parse_from_toml()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#corgy.corgyparser" class="md-nav__link">
    corgyparser()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#corgy.corgychecker" class="md-nav__link">
    corgychecker()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>corgy</h1>

<div class="doc doc-object doc-class">



<h2 id="corgy.Corgy" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">corgy.Corgy</span>


<a href="#corgy.Corgy" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents first">

  
      <p>Base class for collections of attributes.</p>
<p>To use, subclass <code>Corgy</code>, and declare attributes using type annotations::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from corgy import Corgy

&gt;&gt;&gt; class A(Corgy):
...     x: int
...     y: float
</code></pre></div>
<p>At runtime, class <code>A</code> will have <code>x</code>, and <code>y</code> as properties, so that the class can be
used similar to Python dataclasses::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; a = A()
&gt;&gt;&gt; a.x = 1
&gt;&gt;&gt; a.x
1

&gt;&gt;&gt; a.y
Traceback (most recent call last):
   ...
AttributeError: no value available for attribute `y`

&gt;&gt;&gt; a.y = a.x + 1.1
&gt;&gt;&gt; a.y
2.1

&gt;&gt;&gt; del a.x  # unset x
&gt;&gt;&gt; a.x
Traceback (most recent call last):
   ...
AttributeError: no value available for attribute `x`
</code></pre></div>
<p>Note that the class's <code>__init__</code> method only accepts keyword arguments, and ignores
arguments without a corresponding attribute. The following are all valid::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; A(x=1, y=2.1)
A(x=1, y=2.1)

&gt;&gt;&gt; A(x=1, z=3)  # y is not set, and z is ignored
A(x=1)

&gt;&gt;&gt; A(**{&quot;x&quot;: 1, &quot;y&quot;: 2.1, &quot;z&quot;: 3})
A(x=1, y=2.1)
</code></pre></div>
<p>Attribute values are type-checked, and <code>ValueError</code> is raised on type mismatch::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; a = A(x=&quot;1&quot;)
Traceback (most recent call last):
    ...
ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;int&#39;&gt;&#39;: &#39;1&#39;

&gt;&gt;&gt; a = A()
&gt;&gt;&gt; a.x = &quot;1&quot;
Traceback (most recent call last):
    ...
ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;int&#39;&gt;&#39;: &#39;1&#39;

&gt;&gt;&gt; class A(Corgy):
...     x: int = &quot;1&quot;
Traceback (most recent call last):
    ...
ValueError: default value type mismatch for &#39;x&#39;
</code></pre></div>
<p>Any type which supports type checking with <code>isinstance</code> can be used as an
attribute type (along with some special type annotations that are discussed below).
This includes other corgy classes::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: int
...     y: float

&gt;&gt;&gt; class B(Corgy):
...     x: int
...     a: A

&gt;&gt;&gt; b = B(x=1)
&gt;&gt;&gt; b.a = A()
&gt;&gt;&gt; b.a.x = 10
&gt;&gt;&gt; b
B(x=1, a=A(x=10))
</code></pre></div>
<p><code>Corgy</code> classes have their <code>__slots__</code> set to the annotated attributes. So, if you
want to use additional attributes not tracked by <code>Corgy</code>, define them (and only
them) in <code>__slots__</code>::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     __slots__ = (&quot;x&quot;,)
...     y: int

&gt;&gt;&gt; a = A()
&gt;&gt;&gt; a.y = 1  # `Corgy` attribute
&gt;&gt;&gt; a.x = 2  # custom attribute
&gt;&gt;&gt; a
A(y=1)
</code></pre></div>
<p>To allow arbitrary instance attributes, add <code>__dict__</code> to <code>__slots__</code>. Names added
through custom <code>__slots__</code> are not processed by <code>Corgy</code>. Alternatively, to disable
setting <code>__slots__</code> completely, set <code>corgy_make_slots</code> to <code>False</code> in the class
definition::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy, corgy_make_slots=False):
...     y: int

&gt;&gt;&gt; a = A()
&gt;&gt;&gt; a.y = 1  # `Corgy` attribute
&gt;&gt;&gt; a.x = 2  # custom attribute
&gt;&gt;&gt; a
A(y=1)
</code></pre></div>
<p>Names marked with the <code>ClassVar</code> type will be added as class variables, and will
not be available as <code>Corgy</code> attributes::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from typing import ClassVar

&gt;&gt;&gt; class A(Corgy):
...     x: ClassVar[int] = 3

&gt;&gt;&gt; A.x
3
&gt;&gt;&gt; A.x = 4
&gt;&gt;&gt; A.x
4
&gt;&gt;&gt; a = A()
&gt;&gt;&gt; a.x
4
&gt;&gt;&gt; a.x = 5
Traceback (most recent call last):
    ...
AttributeError: &#39;A&#39; object attribute &#39;x&#39; is read-only
</code></pre></div>
<p>Also note that class variables need to be assigned to a value during definition, and
this value will not be type checked by <code>Corgy</code>.</p>
<p>Inheritance works as expected, whether base classes are themselves <code>Corgy</code> classes
or not, with sub-classes inheriting the attributes of the base class, and overriding
any redefined attributes::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A:
...     x: int

&gt;&gt;&gt; class B(Corgy, A):
...     y: float = 1.0
...     z: str

&gt;&gt;&gt; class C(B):
...     y: float = 2.0
...     z: str
...     w: float

&gt;&gt;&gt; c = C()
&gt;&gt;&gt; print(c)
C(x=&lt;unset&gt;, y=2.0, z=&lt;unset&gt;, w=&lt;unset&gt;)
</code></pre></div>
<p>Tracking of base class attributes can be disabled by setting <code>corgy_track_bases</code> to
<code>False</code> in the class definition. Properties will still be inherited following
standard inheritance rules, but <code>Corgy</code> will ignore them::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A:
...     x: int

&gt;&gt;&gt; class B(Corgy, A, corgy_track_bases=False):
...     y: float = 1.0
...     z: str

&gt;&gt;&gt; b = B()
&gt;&gt;&gt; print(b)
B(y=1.0, z=&lt;unset&gt;)
</code></pre></div>
<p><code>Corgy</code> instances can be frozen (preventing any further changes) using the <code>freeze</code>
method. This method can be called automatically after <code>__init__</code> by by setting
<code>corgy_freeze_after_init</code> to <code>True</code> in the class definition::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy, corgy_freeze_after_init=True):
...    x: int

&gt;&gt;&gt; a = A(x=1)
&gt;&gt;&gt; a.x = 2
Traceback (most recent call last):
    ...
TypeError: cannot set `x`: object is frozen
</code></pre></div>
<p><code>Corgy</code> recognizes a number of special annotations, which are used to control how
attribute values are processed.</p>

<details class="note" open>
  <summary>Note</summary>
  <p>If any of the following annotations are unavailable in the Python version being
used, you can import them from <code>typing_extensions</code> (which is available on PyPI).</p>
</details>      <p><em>Annotations</em>
<code>typing.Annotated</code> can be used to add additional metadata to attributes, akin to
doc strings. It is primarily used to control how attributes are added to
<code>ArgumentParser</code> instances. <code>typing.Annotated</code> is stripped on class creation,
leaving only the base type::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; import sys
&gt;&gt;&gt; if sys.version_info &gt;= (3, 9):
...     from typing import Annotated, Literal
... else:
...     from typing_extensions import Annotated, Literal

&gt;&gt;&gt; class A(Corgy):
...     x: Annotated[int, &quot;this is x&quot;]

&gt;&gt;&gt; A.attrs()
{&#39;x&#39;: &lt;class &#39;int&#39;&gt;}
</code></pre></div>
<p><code>Annotated</code> should always be the outermost type annotation for an attribute.
Refer to the docs for <code>Corgy.add_args_to_parser</code> for details on usage.</p>
<p><em>Required/NotRequired</em>
By default, <code>Corgy</code> attributes are not required, and can be unset. This can be
changed by setting <code>corgy_required_by_default</code> to <code>True</code> in the class definition::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy, corgy_required_by_default=True):
...     x: int

&gt;&gt;&gt; A()
Traceback (most recent call last):
    ...
ValueError: missing required attribute: `x`
&gt;&gt;&gt; a = A(x=1)
&gt;&gt;&gt; del a.x
Traceback (most recent call last):
    ...
TypeError: attribute `x` cannot be unset
</code></pre></div>
<p>Attributes can also explicitly be marked as required/not-required using
<code>corgy.Required</code> and <code>corgy.NotRequired</code> annotations::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from corgy import Required, NotRequired

&gt;&gt;&gt; class A(Corgy):
...     x: Required[int]
...     y: NotRequired[int]
...     z: int  # not required by default

&gt;&gt;&gt; a = A(x=1)
&gt;&gt;&gt; print(a)
A(x=1, y=&lt;unset&gt;, z=&lt;unset&gt;)

&gt;&gt;&gt; class B(Corgy, corgy_required_by_default=True):
...     x: Required[int]
...     y: NotRequired[int]
...     z: int

&gt;&gt;&gt; b = B(x=1, z=2)
&gt;&gt;&gt; print(b)
B(x=1, y=&lt;unset&gt;, z=2)
</code></pre></div>
<p><em>Optional</em>
Annotating an attribute with <code>typing.Optional</code> allows it to be <code>None</code>::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from typing import Optional

&gt;&gt;&gt; class A(Corgy):
...     x: Optional[int]

&gt;&gt;&gt; a = A()
&gt;&gt;&gt; a.x = None
</code></pre></div>
<p>In Python &gt;= 3.10, instead of using <code>typing.Annotated</code>, <code>| None</code> can be used, i.e.,
<code>x: int | None</code> for example.</p>
<p>Note that <code>Optional</code> is not the same as <code>NotRequired</code>. <code>Optional</code> allows an
attribute to be <code>None</code>, while <code>NotRequired</code> allows an attribute to be unset.
A <code>Required</code> <code>Optional</code> attribute will need a value (which can be <code>None</code>)::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: Required[Optional[int]]

&gt;&gt;&gt; A()
Traceback (most recent call last):
    ...
ValueError: missing required attribute: `x`
&gt;&gt;&gt; a = A(x=None)
&gt;&gt;&gt; print(a)
A(x=None)
</code></pre></div>
<p><em>Collections</em>
Several collection types can be used to annotate attributes, which will restrict the
type of accepted values. Values in the collection will be checked to ensure that
they match the annotated collection types. The following collection types are
supported:</p>
<ol>
<li><code>collections.abc.Sequence</code> (<code>typing.Sequence</code> on Python &lt; 3.9)</li>
<li><code>tuple</code> (<code>typing.Tuple</code> on Python &lt; 3.9)</li>
<li><code>list</code> (<code>typing.List</code> on Python &lt; 3.9)</li>
<li><code>set</code> (<code>typing.Set</code> on Python &lt; 3.9)</li>
</ol>
<p>There are a few different ways to use these types, each resulting in different
validation conditions. The simplest case is a plain (possibly empty) collection of a
single type::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from typing import List, Sequence, Set, Tuple

&gt;&gt;&gt; class A(Corgy):
...     x: Sequence[int]
...     y: Tuple[str]
...     z: Set[float]
...     w: List[int]

&gt;&gt;&gt; a = A()
&gt;&gt;&gt; a.x = [1, 2]
&gt;&gt;&gt; a.y = (&quot;1&quot;, &quot;2&quot;)
&gt;&gt;&gt; a.z = {1.0, 2.0}
&gt;&gt;&gt; a.w = [1, 2]
&gt;&gt;&gt; a
A(x=[1, 2], y=(&#39;1&#39;, &#39;2&#39;), z={1.0, 2.0}, w=[1, 2])

&gt;&gt;&gt; a.x = [1, &quot;2&quot;]
Traceback (most recent call last):
    ...
ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;int&#39;&gt;&#39;: &#39;2&#39;

&gt;&gt;&gt; a.x = (1, 2)      # `Sequence` accepts any sequence type

&gt;&gt;&gt; # `Tuple` only accepts tuples
&gt;&gt;&gt; a.y = [&quot;1&quot;, &quot;2&quot;]  # doctest: +NORMALIZE_WHITESPACE
Traceback (most recent call last):
    ...
ValueError: error setting `y`: invalid value for type &#39;typing.Tuple[str]&#39;:
[&#39;1&#39;, &#39;2&#39;]
</code></pre></div>
<p>The collection length can be controlled by the arguments of the type annotation.
Note, however, that <code>typing.Sequence/typing.List/typing.Set</code> do not
accept multiple arguments, and so, cannot be used if collection length has to be
specified. On Python &lt; 3.9, only <code>typing.Tuple</code> can be used for controlling
collection lengths.</p>
<p>To specify that a collection must be non-empty, use ellipsis (<code>...</code>) as the second
argument of the type::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: Tuple[int, ...]

&gt;&gt;&gt; a = A()
&gt;&gt;&gt; a.x = tuple()  # doctest: +NORMALIZE_WHITESPACE
Traceback (most recent call last):
    ...
ValueError: error setting `x`: expected non-empty collection for type
&#39;typing.Tuple[int, ...]&#39;
</code></pre></div>
<p>Collections can also be restricted to be of a fixed length::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: Tuple[int, str]
...     y: Tuple[int, int, int]

&gt;&gt;&gt; a = A()
&gt;&gt;&gt; a.x = (1, 1)
Traceback (most recent call last):
    ...
ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;str&#39;&gt;&#39;: 1

&gt;&gt;&gt; a.y = (1, 1)  # doctest: +NORMALIZE_WHITESPACE
Traceback (most recent call last):
    ...
ValueError: error setting `y`: invalid value for type
&#39;typing.Tuple[int, int, int]&#39;: (1, 1): expected exactly &#39;3&#39; elements
</code></pre></div>
<p><em>Literals</em>
<code>typing.Literal</code> can be used to specify that an attribute takes one of a fixed set
of values::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: Literal[0, 1, &quot;2&quot;]

&gt;&gt;&gt; a = A()
&gt;&gt;&gt; a.x = 0
&gt;&gt;&gt; a.x = &quot;2&quot;
&gt;&gt;&gt; a.x = &quot;1&quot;  # doctest: +IGNORE_EXCEPTION_DETAIL
Traceback (most recent call last):
    ...
ValueError: error setting `x`: invalid value for type
&#39;typing.Literal[0, 1, &#39;2&#39;]&#39;: &#39;1&#39;
</code></pre></div>
<p>Type annotations can be nested; for instance,
<code>Sequence[Literal[0, 1, 2], Literal[0, 1, 2]]</code> represents a sequence of length 2,
where each element is either 0, 1, or 2.</p>
<p>A fixed set of attribute values can also be specified by adding a <code>__choices__</code>
attribute to the argument type, containing a collection of choices::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class T(int):
...     __choices__ = (1, 2)

&gt;&gt;&gt; class A(Corgy):
...     x: T

&gt;&gt;&gt; a = A()
&gt;&gt;&gt; a.x = 1
&gt;&gt;&gt; a.x = 3  # doctest: +NORMALIZE_WHITESPACE
Traceback (most recent call last):
    ...
ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;T&#39;&gt;&#39;: 3:
expected one of: (1, 2)
</code></pre></div>
<p>Note that choices specified in this way are not type-checked to ensure that they
match the argument type; in the above example, <code>__choices__</code> could be set to
<code>(1, "2")</code>.</p>
<p><em>Self</em>
<code>Corgy</code> classes can have attributes of their own type, annotated using
<code>typing.Self</code>.</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; if sys.version_info &gt;= (3, 11):
...     from typing import Self
... else:
...     from typing_extensions import Self

&gt;&gt;&gt; class C(Corgy):
...     x: int
...     c: Self

&gt;&gt;&gt; c = C(x=1)
&gt;&gt;&gt; c.c = C(x=2)
&gt;&gt;&gt; c
C(x=1, c=C(x=2))

&gt;&gt;&gt; class D(C):
...     ...

&gt;&gt;&gt; c.c = D(x=3)  # doctest: +NORMALIZE_WHITESPACE
Traceback (most recent call last):
    ...
ValueError: error setting `c`: invalid value for type &#39;Self (bound to
&lt;class &#39;C&#39;&gt;)&#39;: D(x=3)
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>corgy/_corgy.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Corgy</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">CorgyMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class for collections of attributes.</span>

<span class="sd">    To use, subclass `Corgy`, and declare attributes using type annotations::</span>

<span class="sd">        &gt;&gt;&gt; from corgy import Corgy</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: int</span>
<span class="sd">        ...     y: float</span>

<span class="sd">    At runtime, class `A` will have `x`, and `y` as properties, so that the class can be</span>
<span class="sd">    used similar to Python dataclasses::</span>

<span class="sd">        &gt;&gt;&gt; a = A()</span>
<span class="sd">        &gt;&gt;&gt; a.x = 1</span>
<span class="sd">        &gt;&gt;&gt; a.x</span>
<span class="sd">        1</span>

<span class="sd">        &gt;&gt;&gt; a.y</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">           ...</span>
<span class="sd">        AttributeError: no value available for attribute `y`</span>

<span class="sd">        &gt;&gt;&gt; a.y = a.x + 1.1</span>
<span class="sd">        &gt;&gt;&gt; a.y</span>
<span class="sd">        2.1</span>

<span class="sd">        &gt;&gt;&gt; del a.x  # unset x</span>
<span class="sd">        &gt;&gt;&gt; a.x</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">           ...</span>
<span class="sd">        AttributeError: no value available for attribute `x`</span>

<span class="sd">    Note that the class&#39;s `__init__` method only accepts keyword arguments, and ignores</span>
<span class="sd">    arguments without a corresponding attribute. The following are all valid::</span>

<span class="sd">        &gt;&gt;&gt; A(x=1, y=2.1)</span>
<span class="sd">        A(x=1, y=2.1)</span>

<span class="sd">        &gt;&gt;&gt; A(x=1, z=3)  # y is not set, and z is ignored</span>
<span class="sd">        A(x=1)</span>

<span class="sd">        &gt;&gt;&gt; A(**{&quot;x&quot;: 1, &quot;y&quot;: 2.1, &quot;z&quot;: 3})</span>
<span class="sd">        A(x=1, y=2.1)</span>

<span class="sd">    Attribute values are type-checked, and `ValueError` is raised on type mismatch::</span>

<span class="sd">        &gt;&gt;&gt; a = A(x=&quot;1&quot;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;int&#39;&gt;&#39;: &#39;1&#39;</span>

<span class="sd">        &gt;&gt;&gt; a = A()</span>
<span class="sd">        &gt;&gt;&gt; a.x = &quot;1&quot;</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;int&#39;&gt;&#39;: &#39;1&#39;</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: int = &quot;1&quot;</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: default value type mismatch for &#39;x&#39;</span>

<span class="sd">    Any type which supports type checking with `isinstance` can be used as an</span>
<span class="sd">    attribute type (along with some special type annotations that are discussed below).</span>
<span class="sd">    This includes other corgy classes::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: int</span>
<span class="sd">        ...     y: float</span>

<span class="sd">        &gt;&gt;&gt; class B(Corgy):</span>
<span class="sd">        ...     x: int</span>
<span class="sd">        ...     a: A</span>

<span class="sd">        &gt;&gt;&gt; b = B(x=1)</span>
<span class="sd">        &gt;&gt;&gt; b.a = A()</span>
<span class="sd">        &gt;&gt;&gt; b.a.x = 10</span>
<span class="sd">        &gt;&gt;&gt; b</span>
<span class="sd">        B(x=1, a=A(x=10))</span>

<span class="sd">    `Corgy` classes have their `__slots__` set to the annotated attributes. So, if you</span>
<span class="sd">    want to use additional attributes not tracked by `Corgy`, define them (and only</span>
<span class="sd">    them) in `__slots__`::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     __slots__ = (&quot;x&quot;,)</span>
<span class="sd">        ...     y: int</span>

<span class="sd">        &gt;&gt;&gt; a = A()</span>
<span class="sd">        &gt;&gt;&gt; a.y = 1  # `Corgy` attribute</span>
<span class="sd">        &gt;&gt;&gt; a.x = 2  # custom attribute</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        A(y=1)</span>

<span class="sd">    To allow arbitrary instance attributes, add `__dict__` to `__slots__`. Names added</span>
<span class="sd">    through custom `__slots__` are not processed by `Corgy`. Alternatively, to disable</span>
<span class="sd">    setting `__slots__` completely, set `corgy_make_slots` to `False` in the class</span>
<span class="sd">    definition::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy, corgy_make_slots=False):</span>
<span class="sd">        ...     y: int</span>

<span class="sd">        &gt;&gt;&gt; a = A()</span>
<span class="sd">        &gt;&gt;&gt; a.y = 1  # `Corgy` attribute</span>
<span class="sd">        &gt;&gt;&gt; a.x = 2  # custom attribute</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        A(y=1)</span>

<span class="sd">    Names marked with the `ClassVar` type will be added as class variables, and will</span>
<span class="sd">    not be available as `Corgy` attributes::</span>

<span class="sd">        &gt;&gt;&gt; from typing import ClassVar</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: ClassVar[int] = 3</span>

<span class="sd">        &gt;&gt;&gt; A.x</span>
<span class="sd">        3</span>
<span class="sd">        &gt;&gt;&gt; A.x = 4</span>
<span class="sd">        &gt;&gt;&gt; A.x</span>
<span class="sd">        4</span>
<span class="sd">        &gt;&gt;&gt; a = A()</span>
<span class="sd">        &gt;&gt;&gt; a.x</span>
<span class="sd">        4</span>
<span class="sd">        &gt;&gt;&gt; a.x = 5</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        AttributeError: &#39;A&#39; object attribute &#39;x&#39; is read-only</span>

<span class="sd">    Also note that class variables need to be assigned to a value during definition, and</span>
<span class="sd">    this value will not be type checked by `Corgy`.</span>

<span class="sd">    Inheritance works as expected, whether base classes are themselves `Corgy` classes</span>
<span class="sd">    or not, with sub-classes inheriting the attributes of the base class, and overriding</span>
<span class="sd">    any redefined attributes::</span>

<span class="sd">        &gt;&gt;&gt; class A:</span>
<span class="sd">        ...     x: int</span>

<span class="sd">        &gt;&gt;&gt; class B(Corgy, A):</span>
<span class="sd">        ...     y: float = 1.0</span>
<span class="sd">        ...     z: str</span>

<span class="sd">        &gt;&gt;&gt; class C(B):</span>
<span class="sd">        ...     y: float = 2.0</span>
<span class="sd">        ...     z: str</span>
<span class="sd">        ...     w: float</span>

<span class="sd">        &gt;&gt;&gt; c = C()</span>
<span class="sd">        &gt;&gt;&gt; print(c)</span>
<span class="sd">        C(x=&lt;unset&gt;, y=2.0, z=&lt;unset&gt;, w=&lt;unset&gt;)</span>

<span class="sd">    Tracking of base class attributes can be disabled by setting `corgy_track_bases` to</span>
<span class="sd">    `False` in the class definition. Properties will still be inherited following</span>
<span class="sd">    standard inheritance rules, but `Corgy` will ignore them::</span>

<span class="sd">        &gt;&gt;&gt; class A:</span>
<span class="sd">        ...     x: int</span>

<span class="sd">        &gt;&gt;&gt; class B(Corgy, A, corgy_track_bases=False):</span>
<span class="sd">        ...     y: float = 1.0</span>
<span class="sd">        ...     z: str</span>

<span class="sd">        &gt;&gt;&gt; b = B()</span>
<span class="sd">        &gt;&gt;&gt; print(b)</span>
<span class="sd">        B(y=1.0, z=&lt;unset&gt;)</span>

<span class="sd">    `Corgy` instances can be frozen (preventing any further changes) using the `freeze`</span>
<span class="sd">    method. This method can be called automatically after `__init__` by by setting</span>
<span class="sd">    `corgy_freeze_after_init` to `True` in the class definition::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy, corgy_freeze_after_init=True):</span>
<span class="sd">        ...    x: int</span>

<span class="sd">        &gt;&gt;&gt; a = A(x=1)</span>
<span class="sd">        &gt;&gt;&gt; a.x = 2</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        TypeError: cannot set `x`: object is frozen</span>

<span class="sd">    `Corgy` recognizes a number of special annotations, which are used to control how</span>
<span class="sd">    attribute values are processed.</span>

<span class="sd">    Note:</span>
<span class="sd">        If any of the following annotations are unavailable in the Python version being</span>
<span class="sd">        used, you can import them from `typing_extensions` (which is available on PyPI).</span>

<span class="sd">    *Annotations*</span>
<span class="sd">    `typing.Annotated` can be used to add additional metadata to attributes, akin to</span>
<span class="sd">    doc strings. It is primarily used to control how attributes are added to</span>
<span class="sd">    `ArgumentParser` instances. `typing.Annotated` is stripped on class creation,</span>
<span class="sd">    leaving only the base type::</span>

<span class="sd">        &gt;&gt;&gt; import sys</span>
<span class="sd">        &gt;&gt;&gt; if sys.version_info &gt;= (3, 9):</span>
<span class="sd">        ...     from typing import Annotated, Literal</span>
<span class="sd">        ... else:</span>
<span class="sd">        ...     from typing_extensions import Annotated, Literal</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Annotated[int, &quot;this is x&quot;]</span>

<span class="sd">        &gt;&gt;&gt; A.attrs()</span>
<span class="sd">        {&#39;x&#39;: &lt;class &#39;int&#39;&gt;}</span>

<span class="sd">    `Annotated` should always be the outermost type annotation for an attribute.</span>
<span class="sd">    Refer to the docs for `Corgy.add_args_to_parser` for details on usage.</span>

<span class="sd">    *Required/NotRequired*</span>
<span class="sd">    By default, `Corgy` attributes are not required, and can be unset. This can be</span>
<span class="sd">    changed by setting `corgy_required_by_default` to `True` in the class definition::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy, corgy_required_by_default=True):</span>
<span class="sd">        ...     x: int</span>

<span class="sd">        &gt;&gt;&gt; A()</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: missing required attribute: `x`</span>
<span class="sd">        &gt;&gt;&gt; a = A(x=1)</span>
<span class="sd">        &gt;&gt;&gt; del a.x</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        TypeError: attribute `x` cannot be unset</span>

<span class="sd">    Attributes can also explicitly be marked as required/not-required using</span>
<span class="sd">    `corgy.Required` and `corgy.NotRequired` annotations::</span>

<span class="sd">        &gt;&gt;&gt; from corgy import Required, NotRequired</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Required[int]</span>
<span class="sd">        ...     y: NotRequired[int]</span>
<span class="sd">        ...     z: int  # not required by default</span>

<span class="sd">        &gt;&gt;&gt; a = A(x=1)</span>
<span class="sd">        &gt;&gt;&gt; print(a)</span>
<span class="sd">        A(x=1, y=&lt;unset&gt;, z=&lt;unset&gt;)</span>

<span class="sd">        &gt;&gt;&gt; class B(Corgy, corgy_required_by_default=True):</span>
<span class="sd">        ...     x: Required[int]</span>
<span class="sd">        ...     y: NotRequired[int]</span>
<span class="sd">        ...     z: int</span>

<span class="sd">        &gt;&gt;&gt; b = B(x=1, z=2)</span>
<span class="sd">        &gt;&gt;&gt; print(b)</span>
<span class="sd">        B(x=1, y=&lt;unset&gt;, z=2)</span>

<span class="sd">    *Optional*</span>
<span class="sd">    Annotating an attribute with `typing.Optional` allows it to be `None`::</span>

<span class="sd">        &gt;&gt;&gt; from typing import Optional</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Optional[int]</span>

<span class="sd">        &gt;&gt;&gt; a = A()</span>
<span class="sd">        &gt;&gt;&gt; a.x = None</span>

<span class="sd">    In Python &gt;= 3.10, instead of using `typing.Annotated`, `| None` can be used, i.e.,</span>
<span class="sd">    `x: int | None` for example.</span>

<span class="sd">    Note that `Optional` is not the same as `NotRequired`. `Optional` allows an</span>
<span class="sd">    attribute to be `None`, while `NotRequired` allows an attribute to be unset.</span>
<span class="sd">    A `Required` `Optional` attribute will need a value (which can be `None`)::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Required[Optional[int]]</span>

<span class="sd">        &gt;&gt;&gt; A()</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: missing required attribute: `x`</span>
<span class="sd">        &gt;&gt;&gt; a = A(x=None)</span>
<span class="sd">        &gt;&gt;&gt; print(a)</span>
<span class="sd">        A(x=None)</span>

<span class="sd">    *Collections*</span>
<span class="sd">    Several collection types can be used to annotate attributes, which will restrict the</span>
<span class="sd">    type of accepted values. Values in the collection will be checked to ensure that</span>
<span class="sd">    they match the annotated collection types. The following collection types are</span>
<span class="sd">    supported:</span>

<span class="sd">    1. `collections.abc.Sequence` (`typing.Sequence` on Python &lt; 3.9)</span>
<span class="sd">    2. `tuple` (`typing.Tuple` on Python &lt; 3.9)</span>
<span class="sd">    3. `list` (`typing.List` on Python &lt; 3.9)</span>
<span class="sd">    4. `set` (`typing.Set` on Python &lt; 3.9)</span>

<span class="sd">    There are a few different ways to use these types, each resulting in different</span>
<span class="sd">    validation conditions. The simplest case is a plain (possibly empty) collection of a</span>
<span class="sd">    single type::</span>

<span class="sd">        &gt;&gt;&gt; from typing import List, Sequence, Set, Tuple</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Sequence[int]</span>
<span class="sd">        ...     y: Tuple[str]</span>
<span class="sd">        ...     z: Set[float]</span>
<span class="sd">        ...     w: List[int]</span>

<span class="sd">        &gt;&gt;&gt; a = A()</span>
<span class="sd">        &gt;&gt;&gt; a.x = [1, 2]</span>
<span class="sd">        &gt;&gt;&gt; a.y = (&quot;1&quot;, &quot;2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a.z = {1.0, 2.0}</span>
<span class="sd">        &gt;&gt;&gt; a.w = [1, 2]</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        A(x=[1, 2], y=(&#39;1&#39;, &#39;2&#39;), z={1.0, 2.0}, w=[1, 2])</span>

<span class="sd">        &gt;&gt;&gt; a.x = [1, &quot;2&quot;]</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;int&#39;&gt;&#39;: &#39;2&#39;</span>

<span class="sd">        &gt;&gt;&gt; a.x = (1, 2)      # `Sequence` accepts any sequence type</span>

<span class="sd">        &gt;&gt;&gt; # `Tuple` only accepts tuples</span>
<span class="sd">        &gt;&gt;&gt; a.y = [&quot;1&quot;, &quot;2&quot;]  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: error setting `y`: invalid value for type &#39;typing.Tuple[str]&#39;:</span>
<span class="sd">        [&#39;1&#39;, &#39;2&#39;]</span>

<span class="sd">    The collection length can be controlled by the arguments of the type annotation.</span>
<span class="sd">    Note, however, that `typing.Sequence/typing.List/typing.Set` do not</span>
<span class="sd">    accept multiple arguments, and so, cannot be used if collection length has to be</span>
<span class="sd">    specified. On Python &lt; 3.9, only `typing.Tuple` can be used for controlling</span>
<span class="sd">    collection lengths.</span>

<span class="sd">    To specify that a collection must be non-empty, use ellipsis (`...`) as the second</span>
<span class="sd">    argument of the type::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Tuple[int, ...]</span>

<span class="sd">        &gt;&gt;&gt; a = A()</span>
<span class="sd">        &gt;&gt;&gt; a.x = tuple()  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: error setting `x`: expected non-empty collection for type</span>
<span class="sd">        &#39;typing.Tuple[int, ...]&#39;</span>

<span class="sd">    Collections can also be restricted to be of a fixed length::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Tuple[int, str]</span>
<span class="sd">        ...     y: Tuple[int, int, int]</span>

<span class="sd">        &gt;&gt;&gt; a = A()</span>
<span class="sd">        &gt;&gt;&gt; a.x = (1, 1)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;str&#39;&gt;&#39;: 1</span>

<span class="sd">        &gt;&gt;&gt; a.y = (1, 1)  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: error setting `y`: invalid value for type</span>
<span class="sd">        &#39;typing.Tuple[int, int, int]&#39;: (1, 1): expected exactly &#39;3&#39; elements</span>

<span class="sd">    *Literals*</span>
<span class="sd">    `typing.Literal` can be used to specify that an attribute takes one of a fixed set</span>
<span class="sd">    of values::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Literal[0, 1, &quot;2&quot;]</span>

<span class="sd">        &gt;&gt;&gt; a = A()</span>
<span class="sd">        &gt;&gt;&gt; a.x = 0</span>
<span class="sd">        &gt;&gt;&gt; a.x = &quot;2&quot;</span>
<span class="sd">        &gt;&gt;&gt; a.x = &quot;1&quot;  # doctest: +IGNORE_EXCEPTION_DETAIL</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: error setting `x`: invalid value for type</span>
<span class="sd">        &#39;typing.Literal[0, 1, &#39;2&#39;]&#39;: &#39;1&#39;</span>

<span class="sd">    Type annotations can be nested; for instance,</span>
<span class="sd">    `Sequence[Literal[0, 1, 2], Literal[0, 1, 2]]` represents a sequence of length 2,</span>
<span class="sd">    where each element is either 0, 1, or 2.</span>

<span class="sd">    A fixed set of attribute values can also be specified by adding a `__choices__`</span>
<span class="sd">    attribute to the argument type, containing a collection of choices::</span>

<span class="sd">        &gt;&gt;&gt; class T(int):</span>
<span class="sd">        ...     __choices__ = (1, 2)</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: T</span>

<span class="sd">        &gt;&gt;&gt; a = A()</span>
<span class="sd">        &gt;&gt;&gt; a.x = 1</span>
<span class="sd">        &gt;&gt;&gt; a.x = 3  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;T&#39;&gt;&#39;: 3:</span>
<span class="sd">        expected one of: (1, 2)</span>

<span class="sd">    Note that choices specified in this way are not type-checked to ensure that they</span>
<span class="sd">    match the argument type; in the above example, `__choices__` could be set to</span>
<span class="sd">    `(1, &quot;2&quot;)`.</span>

<span class="sd">    *Self*</span>
<span class="sd">    `Corgy` classes can have attributes of their own type, annotated using</span>
<span class="sd">    `typing.Self`.</span>

<span class="sd">        &gt;&gt;&gt; if sys.version_info &gt;= (3, 11):</span>
<span class="sd">        ...     from typing import Self</span>
<span class="sd">        ... else:</span>
<span class="sd">        ...     from typing_extensions import Self</span>

<span class="sd">        &gt;&gt;&gt; class C(Corgy):</span>
<span class="sd">        ...     x: int</span>
<span class="sd">        ...     c: Self</span>

<span class="sd">        &gt;&gt;&gt; c = C(x=1)</span>
<span class="sd">        &gt;&gt;&gt; c.c = C(x=2)</span>
<span class="sd">        &gt;&gt;&gt; c</span>
<span class="sd">        C(x=1, c=C(x=2))</span>

<span class="sd">        &gt;&gt;&gt; class D(C):</span>
<span class="sd">        ...     ...</span>

<span class="sd">        &gt;&gt;&gt; c.c = D(x=3)  # doctest: +NORMALIZE_WHITESPACE</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: error setting `c`: invalid value for type &#39;Self (bound to</span>
<span class="sd">        &lt;class &#39;C&#39;&gt;)&#39;: D(x=3)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_args_to_parser</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">parser</span><span class="p">:</span> <span class="n">_ActionsContainer</span><span class="p">,</span>
        <span class="n">name_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">flatten_subgrps</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the class&#39; `Corgy` attributes to the given parser.</span>

<span class="sd">        Args:</span>
<span class="sd">            parser: Argument parser/group to which the attributes will be added.</span>
<span class="sd">            name_prefix: Prefix for argument names. Arguments will be named</span>
<span class="sd">                `--&lt;name-prefix&gt;:&lt;attr-name&gt;`. If custom flags are present,</span>
<span class="sd">                `--&lt;name-prefix&gt;:&lt;flag&gt;` will be used instead (one for each flag).</span>
<span class="sd">            flatten_subgrps: Whether to add sub-groups to the main parser instead of</span>
<span class="sd">                creating argument groups. Note: sub-sub-groups are always added with</span>
<span class="sd">                this argument set to `True`, since `argparse` in unable to properly</span>
<span class="sd">                display nested group arguments.</span>
<span class="sd">            defaults: Optional mapping with default values for arguments. Any value</span>
<span class="sd">                specified here will override default values specified in the class.</span>
<span class="sd">                Values for groups can be specified either as `Corgy` instances, or as</span>
<span class="sd">                individual values using the same syntax as for `Corgy.from_dict`.</span>

<span class="sd">        Type annotations control how attributes are added to the parser. A number of</span>
<span class="sd">        special annotations are parsed and stripped from attribute types to determine</span>
<span class="sd">        the parameters for calling `ArgumentParser.add_argument`. These special</span>
<span class="sd">        annotations are described below.</span>

<span class="sd">        Note: `add_args_to_parser` cannot be used if the type annotation for any</span>
<span class="sd">        attribute of the class includes `Self`, unless a custom parser is defined</span>
<span class="sd">        for such attributes. See docs for `corgyparser` on how to define custom</span>
<span class="sd">        parsers.</span>

<span class="sd">        *Annotated*</span>
<span class="sd">        `typing.Annotated` can be used to add a help message for the argument::</span>

<span class="sd">            &gt;&gt;&gt; import argparse</span>
<span class="sd">            &gt;&gt;&gt; from argparse import ArgumentParser</span>
<span class="sd">            &gt;&gt;&gt; from corgy import CorgyHelpFormatter</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: Annotated[int, &quot;help for x&quot;]</span>

<span class="sd">            &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">            ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">            ...     add_help=False,</span>
<span class="sd">            ...     usage=argparse.SUPPRESS,</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">            &gt;&gt;&gt; parser.print_help()</span>
<span class="sd">            options:</span>
<span class="sd">              --x int  help for x (optional)</span>

<span class="sd">        This annotation can also be used to modify the parser flags for the argument. By</span>
<span class="sd">        default, the attribute name is used, prefixed with `--`, and with `_` replaced</span>
<span class="sd">        by `-`. If the custom flag does not have a leading `-`, a positional argument</span>
<span class="sd">        will be created::</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: Annotated[int, &quot;help for x&quot;, [&quot;-x&quot;, &quot;--ex&quot;]]</span>
<span class="sd">            ...     y: Annotated[int, &quot;help for y&quot;, [&quot;y&quot;]]</span>

<span class="sd">            &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">            ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">            ...     add_help=False,</span>
<span class="sd">            ...     usage=argparse.SUPPRESS,</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">            &gt;&gt;&gt; parser.print_help()</span>
<span class="sd">            positional arguments:</span>
<span class="sd">              y int        help for y</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">            options:</span>
<span class="sd">              -x/--ex int  help for x (optional)</span>

<span class="sd">        `Annotated` can accept multiple arguments, but only the first three are used</span>
<span class="sd">        by `Corgy`. The first argument is the attribute type, the second is the help</span>
<span class="sd">        message (which must be a string), and the third is a sequence of flags.</span>

<span class="sd">        *Required/NotRequired*</span>
<span class="sd">        Every corgy attribute is either required or not required. The default status</span>
<span class="sd">        depends on the class parameter `corgy_required_by_default` (`False` by default).</span>
<span class="sd">        Attributes can also be explicitly marked as required or not required, and will</span>
<span class="sd">        control whether the argument will be added with `required=True`::</span>

<span class="sd">            &gt;&gt;&gt; from corgy import Required, NotRequired</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: Required[int]</span>
<span class="sd">            ...     y: NotRequired[int]</span>
<span class="sd">            ...     z: int</span>

<span class="sd">            &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">            ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">            ...     add_help=False,</span>
<span class="sd">            ...     usage=argparse.SUPPRESS,</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">            &gt;&gt;&gt; parser.print_help()</span>
<span class="sd">            options:</span>
<span class="sd">              --x int  (required)</span>
<span class="sd">              --y int  (optional)</span>
<span class="sd">              --z int  (optional)</span>

<span class="sd">        Attributes which are not required, and don&#39;t have a default value are added</span>
<span class="sd">        with `default=argparse.SUPPRESS`, and so will not be in the parsed namespace::</span>

<span class="sd">            &gt;&gt;&gt; parser.parse_args([&quot;--x&quot;, &quot;1&quot;, &quot;--y&quot;, &quot;2&quot;])</span>
<span class="sd">            Namespace(x=1, y=2)</span>

<span class="sd">        *Optional*</span>
<span class="sd">        Attributes marked with `typing.Optional` are allowed to be `None`. The</span>
<span class="sd">        arguments for these attributes can be passed with no values (i.e. `--x`</span>
<span class="sd">        instead of `--x=1` or `--x 1`) to indicate that the value should be `None`.</span>

<span class="sd">        Note: Attributes with default values are also &quot;optional&quot; in the sense that</span>
<span class="sd">        they can be omitted from the command line. However, they are not the same as</span>
<span class="sd">        attributes marked with `Optional`, since the former are not allowed to be</span>
<span class="sd">        `None`. Furthermore, `Required` `Optional` attributes without default values</span>
<span class="sd">        _will_ need to be passed on the command line (possibly with no values).</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: Required[Optional[int]]</span>

<span class="sd">            &gt;&gt;&gt; parser = ArgumentParser()</span>
<span class="sd">            &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">            &gt;&gt;&gt; parser.parse_args([&quot;--x&quot;])</span>
<span class="sd">            Namespace(x=None)</span>

<span class="sd">        *Boolean*</span>
<span class="sd">        `bool` types (when not in a collection) are converted to a pair of options::</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     arg: bool</span>

<span class="sd">            &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">            ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">            ...     add_help=False,</span>
<span class="sd">            ...     usage=argparse.SUPPRESS,</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">            &gt;&gt;&gt; parser.print_help()</span>
<span class="sd">            options:</span>
<span class="sd">              --arg/--no-arg</span>

<span class="sd">        *Collection*</span>
<span class="sd">        Collection types are added to the parser by setting `nargs`. The value for</span>
<span class="sd">        `nargs` is determined by the collection type. Plain collections, such as</span>
<span class="sd">        `Sequence[int]`, will be added with `nargs=*`; Non-empty collections, such as</span>
<span class="sd">        `Sequence[int, ...]`, will be added with `nargs=+`; Finally, fixed-length</span>
<span class="sd">        collections, such as `Sequence[int, int, int]`, will be added with `nargs` set</span>
<span class="sd">        to the length of the collection.</span>

<span class="sd">        In all cases, collection types can only be added to a parser if they are single</span>
<span class="sd">        type. Heterogenous collections, such as `Sequence[int, str]` cannot be added,</span>
<span class="sd">        and will raise `ValueError`. Untyped collections (e.g., `x: Sequence`), also</span>
<span class="sd">        cannot be added.</span>

<span class="sd">        Arguments for optional collections will also accept no values to indicate</span>
<span class="sd">        `None`. Due to this, it is not possible to parse an empty collection for</span>
<span class="sd">        an optional collection argument::</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: Optional[Sequence[int]]</span>
<span class="sd">            ...     y: Sequence[int]</span>

<span class="sd">            &gt;&gt;&gt; parser = ArgumentParser()</span>
<span class="sd">            &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">            &gt;&gt;&gt; parser.parse_args([&quot;--x&quot;, &quot;--y&quot;])</span>
<span class="sd">            Namespace(x=None, y=[])</span>

<span class="sd">        *Literal*</span>
<span class="sd">        For `Literal` types, the provided values are passed to the `choices` argument</span>
<span class="sd">        of `ArgumentParser.add_argument`. All values must be of the same type, which</span>
<span class="sd">        will be inferred from the type of the first value. If the first value has a</span>
<span class="sd">        `__bases__` attribute, the type will be inferred as the first base type, and</span>
<span class="sd">        all other choices must be subclasses of that type::</span>

<span class="sd">            &gt;&gt;&gt; class T: ...</span>
<span class="sd">            &gt;&gt;&gt; class T1(T): ...</span>
<span class="sd">            &gt;&gt;&gt; class T2(T): ...</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: Literal[T1, T2]</span>

<span class="sd">            &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">            ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">            ...     add_help=False,</span>
<span class="sd">            ...     usage=argparse.SUPPRESS,</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">            &gt;&gt;&gt; parser.print_help()</span>
<span class="sd">            options:</span>
<span class="sd">              --x T  ({T1/T2} optional)</span>

<span class="sd">        For types which specify choices by defining `__choices__`, the values are</span>
<span class="sd">        passed to the `choices` argument as with `Literal`, but no type inference is</span>
<span class="sd">        performed, and the base attribute type will be used as the argument type.</span>

<span class="sd">        **Single-value Literals**</span>
<span class="sd">        A special case for `Literal` types is when there is only one choice. In this</span>
<span class="sd">        case, the argument is added as a `store_const` action, with the value as the</span>
<span class="sd">        `const` argument. A further special case is when the choice is `True/False`,</span>
<span class="sd">        in which case the action is `store_true`/`store_false` respectively::</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: Literal[True]</span>
<span class="sd">            ...     y: Literal[False]</span>
<span class="sd">            ...     z: Literal[42]</span>

<span class="sd">            &gt;&gt;&gt; parser = ArgumentParser()</span>
<span class="sd">            &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">            &gt;&gt;&gt; parser.parse_args([&quot;--x&quot;])  # Note that `y` and `z` are absent</span>
<span class="sd">            Namespace(x=True)</span>
<span class="sd">            &gt;&gt;&gt; parser.parse_args([&quot;--y&quot;])</span>
<span class="sd">            Namespace(y=False)</span>
<span class="sd">            &gt;&gt;&gt; parser.parse_args([&quot;--z&quot;])</span>
<span class="sd">            Namespace(z=42)</span>

<span class="sd">        Note: This special case only applies to `Literal` types, and not types which</span>
<span class="sd">        define `__choices__`.</span>

<span class="sd">        *Corgy*</span>
<span class="sd">        Attributes which are themselves `Corgy` types are treated as argument groups.</span>
<span class="sd">        Group arguments are added to the command line parser with the group attribute</span>
<span class="sd">        name prefixed. Note that groups will ignore any custom flags when computing the</span>
<span class="sd">        prefix; elements within the group will use custom flags, but because they are</span>
<span class="sd">        prefixed with `--`, they will not be positional.</span>

<span class="sd">        Example::</span>

<span class="sd">            &gt;&gt;&gt; class G(Corgy):</span>
<span class="sd">            ...     x: int = 0</span>
<span class="sd">            ...     y: float</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: int</span>
<span class="sd">            ...     g: G</span>

<span class="sd">            &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">            ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">            ...     add_help=False,</span>
<span class="sd">            ...     usage=argparse.SUPPRESS,</span>
<span class="sd">            ... )</span>

<span class="sd">            &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">            &gt;&gt;&gt; parser.print_help()</span>
<span class="sd">            options:</span>
<span class="sd">              --x int      (optional)</span>
<span class="sd">            &lt;BLANKLINE&gt;</span>
<span class="sd">            g:</span>
<span class="sd">              --g:x int    (default: 0)</span>
<span class="sd">              --g:y float  (optional)</span>

<span class="sd">        **Custom parsers**</span>

<span class="sd">        Attributes for which a custom parser is defined using `@corgyparser` will</span>
<span class="sd">        be added with a custom action that will call the parser. Refer to the</span>
<span class="sd">        documentation for `corgyparser` for details.</span>

<span class="sd">        **Metavar**</span>

<span class="sd">        This function will not explicitly pass a value for the `metavar` argument of</span>
<span class="sd">        `ArgumentParser.add_argument`, unless an attribute&#39;s type defines `__metavar__`,</span>
<span class="sd">        in which case, it will be passed as is. To change the metavar for attributes</span>
<span class="sd">        with custom parsers, set the `metavar` argument of `corgyparser`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">base_parser</span> <span class="o">=</span> <span class="n">parser</span>
        <span class="n">base_defaults</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;__defaults&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">defaults</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base_defaults</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span>

        <span class="c1"># Extract default values for group arguments specified individually using</span>
        <span class="c1"># the `&lt;group&gt;:&lt;var name&gt;` syntax.</span>
        <span class="n">group_arg_defaults</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_k</span><span class="p">,</span> <span class="n">_v</span> <span class="ow">in</span> <span class="n">base_defaults</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">_k</span><span class="p">:</span>
                <span class="n">_grp_name</span><span class="p">,</span> <span class="n">_var_name</span> <span class="o">=</span> <span class="n">_k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
                <span class="n">group_arg_defaults</span><span class="p">[</span><span class="n">_grp_name</span><span class="p">][</span><span class="n">_var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_v</span>
            <span class="k">elif</span> <span class="n">_k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;default value for unknown argument: `</span><span class="si">{</span><span class="n">_k</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">)</span>

        <span class="n">required_attrs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;__required&quot;</span><span class="p">)</span>
        <span class="n">custom_flags</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;__flags&quot;</span><span class="p">)</span>
        <span class="n">custom_parsers</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;__parsers&quot;</span><span class="p">)</span>

        <span class="nd">@dataclass</span>
        <span class="k">class</span> <span class="nc">_Arg</span><span class="p">:</span>
            <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
            <span class="n">required</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">positional</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">dest</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">flags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">help</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">nargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">action</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">argparse</span><span class="o">.</span><span class="n">Action</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">choices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">metavar</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">add_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">const</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">def</span> <span class="nf">get_add_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">custom_flags</span><span class="p">):</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dest&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;help&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;nargs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;action&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;choices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">base_defaults</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_defaults</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;required&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metavar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;metavar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metavar</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_type</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">const</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;const&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">const</span>

                <span class="k">return</span> <span class="n">kwargs</span>

            <span class="k">def</span> <span class="nf">process_optional</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">is_optional_type</span><span class="p">(</span><span class="n">type_</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">OptionalTypeAction</span>
                    <span class="k">return</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">type_</span>

            <span class="k">def</span> <span class="nf">process_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
                <span class="n">_col_type</span> <span class="o">=</span> <span class="n">get_concrete_collection_type</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">_col_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="s2">&quot;__args__&quot;</span><span class="p">)</span>
                        <span class="ow">or</span> <span class="ow">not</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span>
                        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TypeVar</span><span class="p">)</span>
                    <span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">` is a collection, but has no type arguments:&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot; use `</span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2">[&lt;types&gt;]&quot;</span>
                        <span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">Ellipsis</span><span class="p">:</span>
                        <span class="c1"># `...` is used to represent non-empty collections, e.g.,</span>
                        <span class="c1"># `Sequence[int, ...]`.</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Ensure single type.</span>
                        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">_a</span> <span class="o">!=</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">_a</span> <span class="ow">in</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                                <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">` has unsupported type `</span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2">`: only&quot;</span>
                                <span class="sa">f</span><span class="s2">&quot; single-type collections are supported&quot;</span>
                            <span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">type_</span>

            <span class="k">def</span> <span class="nf">process_choices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
                <span class="n">_is_literal_type</span> <span class="o">=</span> <span class="n">is_literal_type</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">_is_literal_type</span><span class="p">:</span>
                    <span class="c1"># Determine if the first choice has `__bases__`, in which case</span>
                    <span class="c1"># the first base class is the type for the argument.</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">c0_type</span> <span class="o">=</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                        <span class="n">c0_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">f_check_type</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="nb">isinstance</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">f_check_type</span> <span class="o">=</span> <span class="nb">issubclass</span>

                    <span class="c1"># All choices must be of the same type.</span>
                    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="ow">not</span> <span class="n">f_check_type</span><span class="p">(</span><span class="n">_a</span><span class="p">,</span> <span class="n">c0_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">_a</span> <span class="ow">in</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;choices for `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">` not all of type `</span><span class="si">{</span><span class="n">c0_type</span><span class="si">}</span><span class="s2">`: &quot;</span>
                            <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="si">}</span><span class="s2">`&quot;</span>
                        <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span>

                    <span class="c1"># Convert single choice attributes to `store_*` actions.</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                        <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="ow">is</span> <span class="kc">None</span>
                        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="ow">is</span> <span class="kc">None</span>
                    <span class="p">):</span>
                        <span class="n">_choice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">_choice</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">_StoreTrueAction</span>
                        <span class="k">elif</span> <span class="n">_choice</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">_StoreFalseAction</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">_StoreConstAction</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">const</span> <span class="o">=</span> <span class="n">_choice</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="k">return</span> <span class="kc">None</span>
                    <span class="k">return</span> <span class="n">c0_type</span>

                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="s2">&quot;__choices__&quot;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="n">type_</span><span class="o">.</span><span class="n">__choices__</span>

                <span class="k">return</span> <span class="n">type_</span>

        <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">var_type</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">attrs</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">var_arg</span> <span class="o">=</span> <span class="n">_Arg</span><span class="p">(</span><span class="n">var_name</span><span class="p">)</span>
            <span class="n">var_arg</span><span class="o">.</span><span class="n">help</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="bp">cls</span><span class="p">,</span> <span class="n">var_name</span>
            <span class="p">)</span><span class="o">.</span><span class="vm">__doc__</span>  <span class="c1"># doc is stored in the property</span>
            <span class="n">var_arg</span><span class="o">.</span><span class="n">required</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">var_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base_defaults</span> <span class="ow">and</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">required_attrs</span>
            <span class="p">)</span>

            <span class="c1"># Determine add flags.</span>
            <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">custom_flags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="n">var_name</span><span class="p">,</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;--</span><span class="si">{</span><span class="n">var_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="k">assert</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">name_prefix</span><span class="p">:</span>
                <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="sa">f</span><span class="s2">&quot;--</span><span class="si">{</span><span class="n">name_prefix</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">flag</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span>
                <span class="p">]</span>
                <span class="n">var_arg</span><span class="o">.</span><span class="n">dest</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name_prefix</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">var_arg</span><span class="o">.</span><span class="n">dest</span> <span class="o">=</span> <span class="n">var_name</span>

            <span class="c1"># Determine if argument is positional.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">_flag</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_flag</span> <span class="ow">in</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span><span class="p">):</span>
                <span class="c1"># Note: the flags cannot be passed to `add_argument` with `dest` set</span>
                <span class="c1"># to `var_name` since `argparse` will raise an error for passing `dest`</span>
                <span class="c1"># twice (for positional arguments, `argparse` uses the flag to infer the</span>
                <span class="c1"># `dest`).</span>
                <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="p">[</span><span class="n">var_name</span><span class="p">]</span>
                <span class="n">var_arg</span><span class="o">.</span><span class="n">positional</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="n">_flag</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_flag</span> <span class="ow">in</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span><span class="p">):</span>
                <span class="n">var_arg</span><span class="o">.</span><span class="n">positional</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;inconsistent positional/optional flags for </span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2">: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="c1">###################################################################</span>
            <span class="c1"># Check if the variable has a custom parser.</span>
            <span class="k">if</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">custom_parsers</span><span class="p">:</span>
                <span class="n">_var_parser</span> <span class="o">=</span> <span class="n">custom_parsers</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span>
                <span class="n">_var_base_type</span> <span class="o">=</span> <span class="n">var_type</span>
                <span class="c1"># Extract choices if present.</span>
                <span class="k">if</span> <span class="n">is_literal_type</span><span class="p">(</span><span class="n">var_type</span><span class="p">):</span>
                    <span class="n">_var_choices</span> <span class="o">=</span> <span class="n">var_type</span><span class="o">.</span><span class="n">__args__</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">_var_base_type</span> <span class="o">=</span> <span class="n">_var_choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                        <span class="n">_var_base_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">_var_choices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">var_type</span><span class="p">,</span> <span class="s2">&quot;__choices__&quot;</span><span class="p">):</span>
                    <span class="n">_var_choices</span> <span class="o">=</span> <span class="n">var_type</span><span class="o">.</span><span class="n">__choices__</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">_var_choices</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="n">var_arg</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
                    <span class="n">CorgyParserAction</span><span class="p">,</span> <span class="n">_var_parser</span><span class="p">,</span> <span class="n">_var_choices</span>  <span class="c1"># type: ignore</span>
                <span class="p">)</span>
                <span class="n">var_arg</span><span class="o">.</span><span class="n">add_type</span> <span class="o">=</span> <span class="nb">str</span>
                <span class="n">var_arg</span><span class="o">.</span><span class="n">nargs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_var_parser</span><span class="p">,</span> <span class="s2">&quot;__nargs__&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">var_arg</span><span class="o">.</span><span class="n">metavar</span> <span class="o">=</span> <span class="n">_var_parser</span><span class="o">.</span><span class="n">__metavar__</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">var_arg</span><span class="o">.</span><span class="n">metavar</span> <span class="o">=</span> <span class="n">_var_base_type</span><span class="o">.</span><span class="n">__metavar__</span>
                    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                        <span class="k">pass</span>
                <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="o">*</span><span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="o">**</span><span class="n">var_arg</span><span class="o">.</span><span class="n">get_add_kwargs</span><span class="p">())</span>
                <span class="k">continue</span>

            <span class="c1">###################################################################</span>
            <span class="c1"># Check if the variable is also `Corgy` type.</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">var_type</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">type</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
                <span class="c1"># Create an argument group using `&lt;var_type&gt;`.</span>
                <span class="c1"># If there is a default value, pass it using `**defaults`.</span>
                <span class="k">if</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">base_defaults</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">grp_defaults</span> <span class="o">=</span> <span class="n">base_defaults</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
                    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;default value for `</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2">` is not a `Corgy` instance&quot;</span>
                        <span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">grp_defaults</span> <span class="o">=</span> <span class="p">{}</span>

                <span class="c1"># Update defaults with any values specified individually.</span>
                <span class="n">grp_defaults</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">group_arg_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="p">{}))</span>

                <span class="n">grp_parser</span><span class="p">:</span> <span class="n">_ActionsContainer</span>
                <span class="k">if</span> <span class="n">flatten_subgrps</span><span class="p">:</span>
                    <span class="n">grp_parser</span> <span class="o">=</span> <span class="n">base_parser</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">grp_parser</span> <span class="o">=</span> <span class="n">base_parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span>
                        <span class="n">var_arg</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">help</span>
                    <span class="p">)</span>
                <span class="n">var_type</span><span class="o">.</span><span class="n">add_args_to_parser</span><span class="p">(</span>
                    <span class="n">grp_parser</span><span class="p">,</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">grp_defaults</span>
                <span class="p">)</span>
                <span class="k">continue</span>

            <span class="c1">###################################################################</span>
            <span class="c1"># Check if the variable is boolean. Boolean variables are converted to</span>
            <span class="c1"># `--&lt;var-name&gt;`/`--no-&lt;var-name&gt;` arguments (if not positional).</span>
            <span class="k">if</span> <span class="n">var_type</span> <span class="ow">is</span> <span class="nb">bool</span><span class="p">:</span>
                <span class="n">var_arg</span><span class="o">.</span><span class="n">add_type</span> <span class="o">=</span> <span class="nb">bool</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
                    <span class="n">var_arg</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">BooleanOptionalAction</span>
                <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="o">*</span><span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="o">**</span><span class="n">var_arg</span><span class="o">.</span><span class="n">get_add_kwargs</span><span class="p">())</span>
                <span class="k">continue</span>

            <span class="c1">###################################################################</span>
            <span class="c1"># Process annotations.</span>
            <span class="n">var_base_type</span> <span class="o">=</span> <span class="n">var_type</span>
            <span class="n">var_base_type</span> <span class="o">=</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">process_optional</span><span class="p">(</span><span class="n">var_base_type</span><span class="p">)</span>
            <span class="n">var_base_type</span> <span class="o">=</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">process_collection</span><span class="p">(</span><span class="n">var_base_type</span><span class="p">)</span>
            <span class="n">var_base_type</span> <span class="o">=</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">process_choices</span><span class="p">(</span><span class="n">var_base_type</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">var_base_type</span> <span class="ow">is</span> <span class="n">Self</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;&#39;add_args_to_parser&#39; cannot be used with &#39;Self&#39; type present&quot;</span>
                <span class="p">)</span>

            <span class="n">var_arg</span><span class="o">.</span><span class="n">metavar</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">var_base_type</span><span class="p">,</span> <span class="s2">&quot;__metavar__&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">var_arg</span><span class="o">.</span><span class="n">add_type</span> <span class="o">=</span> <span class="n">var_base_type</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="o">*</span><span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="o">**</span><span class="n">var_arg</span><span class="o">.</span><span class="n">get_add_kwargs</span><span class="p">())</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="n">Corgy</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`Corgy` is an abstract class and cannot be instantiated&quot;</span><span class="p">)</span>

        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">__frozen&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="n">cls_attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">()</span>
        <span class="n">cls_defaults</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;__defaults&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">cls_attrs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="n">attr_name</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">cls_defaults</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">cls_defaults</span><span class="p">[</span><span class="n">attr_name</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;__required&quot;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing required attribute: `</span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="s2">&quot;__freeze_after_init&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">freeze</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f_str</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">arg_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">_val_s</span> <span class="o">=</span> <span class="n">f_str</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">f_str</span> <span class="ow">is</span> <span class="nb">repr</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">_val_s</span> <span class="o">=</span> <span class="s2">&quot;&lt;unset&gt;&quot;</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">=&quot;</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">_val_s</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="p">(</span><span class="nb">repr</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_str</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">_attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">():</span>
            <span class="n">_self_has</span><span class="p">,</span> <span class="n">_other_has</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_attr</span><span class="p">),</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">_attr</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_self_has</span> <span class="o">!=</span> <span class="n">_other_has</span><span class="p">:</span>
                <span class="c1"># One instance has `_attr` set; the other doesn&#39;t.</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">_self_has</span><span class="p">:</span>
                <span class="c1"># Both instances don&#39;t have `_attr` set.</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_attr</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">_attr</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">attrs</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary mapping attributes of the class to their types.</span>

<span class="sd">        Example::</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: Annotated[int, &quot;x&quot;]</span>
<span class="sd">            ...     y: Sequence[str]</span>

<span class="sd">            &gt;&gt;&gt; A.attrs()</span>
<span class="sd">            {&#39;x&#39;: &lt;class &#39;int&#39;&gt;, &#39;y&#39;: typing.Sequence[str]}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">_attr</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">_attr</span><span class="p">)</span><span class="o">.</span><span class="n">fget</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">[</span><span class="s2">&quot;return&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">_attr</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__annotations__</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">flatten</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the object as a dictionary.</span>

<span class="sd">        The returned dictionary maps attribute names to their values. Unset attributes</span>
<span class="sd">        are omitted, unless they have default values.</span>

<span class="sd">        Args:</span>
<span class="sd">            recursive: whether to recursively call `as_dict` on attributes which are</span>
<span class="sd">                `Corgy` instances. Otherwise, they are returned as is.</span>
<span class="sd">            flatten: whether to flatten group arguments into `:` separated strings.</span>
<span class="sd">                Only takes effect if `recursive` is `True`.</span>

<span class="sd">        Examples::</span>

<span class="sd">            &gt;&gt;&gt; class G(Corgy):</span>
<span class="sd">            ...     x: int</span>

<span class="sd">            &gt;&gt;&gt; g = G(x=1)</span>
<span class="sd">            &gt;&gt;&gt; g.as_dict()</span>
<span class="sd">            {&#39;x&#39;: 1}</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: str</span>
<span class="sd">            ...     g: G</span>

<span class="sd">            &gt;&gt;&gt; a = A(x=&quot;one&quot;, g=g)</span>
<span class="sd">            &gt;&gt;&gt; a.as_dict(recursive=False)</span>
<span class="sd">            {&#39;x&#39;: &#39;one&#39;, &#39;g&#39;: G(x=1)}</span>
<span class="sd">            &gt;&gt;&gt; a.as_dict()</span>
<span class="sd">            {&#39;x&#39;: &#39;one&#39;, &#39;g&#39;: {&#39;x&#39;: 1}}</span>
<span class="sd">            &gt;&gt;&gt; a.as_dict(flatten=True)</span>
<span class="sd">            {&#39;x&#39;: &#39;one&#39;, &#39;g:x&#39;: 1}</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">dictify_corgys</span><span class="p">(</span><span class="n">_val</span><span class="p">):</span>
            <span class="n">_coll_type</span> <span class="o">=</span> <span class="n">get_concrete_collection_type</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">_val</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">_coll_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_cast_type</span> <span class="o">=</span> <span class="n">_coll_type</span> <span class="k">if</span> <span class="n">_coll_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">AbstractSequence</span> <span class="k">else</span> <span class="nb">list</span>
                <span class="k">return</span> <span class="n">_cast_type</span><span class="p">(</span>  <span class="c1"># pylint: disable=abstract-class-instantiated</span>
                    <span class="p">[</span><span class="n">dictify_corgys</span><span class="p">(</span><span class="n">_val_part</span><span class="p">)</span> <span class="k">for</span> <span class="n">_val_part</span> <span class="ow">in</span> <span class="n">_val</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_val</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">CorgyMeta</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">_val</span><span class="o">.</span><span class="n">as_dict</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="n">flatten</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_val</span>

        <span class="n">self_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">attr_val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">recursive</span><span class="p">:</span>
                <span class="n">attr_val</span> <span class="o">=</span> <span class="n">dictify_corgys</span><span class="p">(</span><span class="n">attr_val</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">flatten</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">attr_type</span><span class="p">,</span> <span class="n">CorgyMeta</span><span class="p">)</span> <span class="ow">or</span> <span class="n">attr_type</span> <span class="ow">is</span> <span class="n">Self</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">_k</span><span class="p">,</span> <span class="n">_v</span> <span class="ow">in</span> <span class="n">attr_val</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="n">_flat_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">_k</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="n">self_dict</span><span class="p">[</span><span class="n">_flat_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_v</span>
                    <span class="k">continue</span>

            <span class="n">self_dict</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">attr_val</span>

        <span class="k">return</span> <span class="n">self_dict</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="n">d</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">try_cast</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a new instance of the class using a dictionary.</span>

<span class="sd">        This is roughly equivalent to `cls(**d)`, with the main exception being that</span>
<span class="sd">        groups can be specified as dictionaries themselves, and will be processed</span>
<span class="sd">        recursively.</span>

<span class="sd">        Args:</span>
<span class="sd">            d: Dictionary to create the instance from.</span>
<span class="sd">            try_cast: Whether to try and cast values which don&#39;t match attribute types.</span>

<span class="sd">        Example::</span>

<span class="sd">            &gt;&gt;&gt; class G(Corgy):</span>
<span class="sd">            ...     x: int</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: str</span>
<span class="sd">            ...     g: G</span>

<span class="sd">            &gt;&gt;&gt; A.from_dict({&quot;x&quot;: &quot;one&quot;, &quot;g&quot;: G(x=1)})</span>
<span class="sd">            A(x=&#39;one&#39;, g=G(x=1))</span>
<span class="sd">            &gt;&gt;&gt; A.from_dict({&quot;x&quot;: &quot;one&quot;, &quot;g&quot;: {&quot;x&quot;: 1}})</span>
<span class="sd">            A(x=&#39;one&#39;, g=G(x=1))</span>
<span class="sd">            &gt;&gt;&gt; A.from_dict({&quot;x&quot;: &quot;one&quot;, &quot;g&quot;: {&quot;x&quot;: &quot;1&quot;}}, try_cast=True)</span>
<span class="sd">            A(x=&#39;one&#39;, g=G(x=1))</span>
<span class="sd">            &gt;&gt;&gt; G.from_dict({&quot;x&quot;: &quot;1&quot;})</span>
<span class="sd">            Traceback (most recent call last):</span>
<span class="sd">                ...</span>
<span class="sd">            ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;int&#39;&gt;&#39;: &#39;1&#39;</span>

<span class="sd">        Group attributes can also be passed directly in the dictionary by prefixing</span>
<span class="sd">        their names with the group name and a colon::</span>

<span class="sd">            &gt;&gt;&gt; A.from_dict({&quot;x&quot;: &quot;one&quot;, &quot;g:x&quot;: 1})</span>
<span class="sd">            A(x=&#39;one&#39;, g=G(x=1))</span>

<span class="sd">            &gt;&gt;&gt; class B(Corgy):</span>
<span class="sd">            ...     x: float</span>
<span class="sd">            ...     a: A</span>

<span class="sd">            &gt;&gt;&gt; B.from_dict({&quot;x&quot;: 1.1, &quot;a:x&quot;: &quot;one&quot;, &quot;a:g:x&quot;: 1})</span>
<span class="sd">            B(x=1.1, a=A(x=&#39;one&#39;, g=G(x=1)))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">main_args_map</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">grp_args_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
        <span class="n">cls_attrs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">attrs</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_val</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">arg_name</span><span class="p">:</span>
                <span class="n">grp_name</span><span class="p">,</span> <span class="n">arg_name_base</span> <span class="o">=</span> <span class="n">arg_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">grp_name</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;invalid argument `</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">`: &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="bp">cls</span><span class="si">}</span><span class="s2">` has no group named `</span><span class="si">{</span><span class="n">grp_name</span><span class="si">}</span><span class="s2">`&quot;</span>
                    <span class="p">)</span>
                <span class="k">if</span> <span class="n">grp_name</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;conflicting arguments: `</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">` and `</span><span class="si">{</span><span class="n">grp_name</span><span class="si">}</span><span class="s2">`&quot;</span>
                    <span class="p">)</span>
                <span class="n">grp_type</span> <span class="o">=</span> <span class="n">cls_attrs</span><span class="p">[</span><span class="n">grp_name</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grp_type</span><span class="p">,</span> <span class="n">CorgyMeta</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">grp_name</span><span class="si">}</span><span class="s2">` is not a `Corgy` class&quot;</span><span class="p">)</span>
                <span class="n">grp_args_map</span><span class="p">[</span><span class="n">grp_name</span><span class="p">][</span><span class="n">arg_name_base</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg_val</span>

            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">):</span>
                <span class="n">arg_type</span> <span class="o">=</span> <span class="n">cls_attrs</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg_type</span><span class="p">,</span> <span class="n">CorgyMeta</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg_val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">grp_args_map</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg_val</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">main_args_map</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg_val</span>

        <span class="k">for</span> <span class="n">grp_name</span><span class="p">,</span> <span class="n">grp_args</span> <span class="ow">in</span> <span class="n">grp_args_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">grp_type</span> <span class="o">=</span> <span class="n">cls_attrs</span><span class="p">[</span><span class="n">grp_name</span><span class="p">]</span>
            <span class="n">main_args_map</span><span class="p">[</span><span class="n">grp_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">grp_type</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">grp_args</span><span class="p">,</span> <span class="n">try_cast</span><span class="p">)</span>

        <span class="n">cls_attrs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">attrs</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_val</span> <span class="ow">in</span> <span class="n">main_args_map</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">arg_name</span> <span class="ow">in</span> <span class="n">cls_attrs</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">main_args_map</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">check_val_type</span><span class="p">(</span>
                        <span class="n">arg_val</span><span class="p">,</span>
                        <span class="n">cls_attrs</span><span class="p">[</span><span class="n">arg_name</span><span class="p">],</span>
                        <span class="n">try_cast</span><span class="p">,</span>
                        <span class="n">try_load_corgy_dicts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">self_type</span><span class="o">=</span><span class="bp">cls</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error setting `</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">`: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">main_args_map</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_dict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">try_cast</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a dictionary into an instance of the class.</span>

<span class="sd">        Previous attributes are overwritten. Sub-dictionaries will be parsed</span>
<span class="sd">        recursively if the corresponding attribute already exists, else will be parsed</span>
<span class="sd">        using `from_dict`. As with `from_dict`, items in the dictionary without</span>
<span class="sd">        corresponding attributes are ignored.</span>

<span class="sd">        Args:</span>
<span class="sd">            d: Dictionary to load.</span>
<span class="sd">            try_cast: Whether to try and cast values which don&#39;t match attribute types.</span>
<span class="sd">            strict: If `True`, attributes with existing values that are not in the</span>
<span class="sd">                dictionary will be unset.</span>

<span class="sd">        Example::</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: int</span>
<span class="sd">            ...     y: str</span>
<span class="sd">            &gt;&gt;&gt; a = A(x=1)</span>
<span class="sd">            &gt;&gt;&gt; _i = id(a)</span>
<span class="sd">            &gt;&gt;&gt; a.load_dict({&quot;y&quot;: &quot;two&quot;})</span>
<span class="sd">            &gt;&gt;&gt; a</span>
<span class="sd">            A(x=1, y=&#39;two&#39;)</span>
<span class="sd">            &gt;&gt;&gt; _i == id(a)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; a.load_dict({&quot;y&quot;: &quot;three&quot;}, strict=True)</span>
<span class="sd">            &gt;&gt;&gt; a</span>
<span class="sd">            A(y=&#39;three&#39;)</span>
<span class="sd">            &gt;&gt;&gt; _i == id(a)</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; a = A()</span>
<span class="sd">            &gt;&gt;&gt; a.load_dict({&quot;x&quot;: &quot;1&quot;})</span>
<span class="sd">            Traceback (most recent call last):</span>
<span class="sd">                ...</span>
<span class="sd">            ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;int&#39;&gt;&#39;: &#39;1&#39;</span>
<span class="sd">            &gt;&gt;&gt; a.load_dict({&quot;x&quot;: &quot;1&quot;}, try_cast=True)</span>
<span class="sd">            &gt;&gt;&gt; a</span>
<span class="sd">            A(x=1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">main_args_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
        <span class="n">cls_attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_val</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">arg_name</span><span class="p">:</span>
                <span class="n">grp_name</span><span class="p">,</span> <span class="n">arg_name_base</span> <span class="o">=</span> <span class="n">arg_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">grp_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cls_attrs</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;invalid argument `</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">`: &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="si">}</span><span class="s2">` has no group named `</span><span class="si">{</span><span class="n">grp_name</span><span class="si">}</span><span class="s2">`&quot;</span>
                    <span class="p">)</span>
                <span class="k">if</span> <span class="n">grp_name</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;conflicting arguments: `</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">` and `</span><span class="si">{</span><span class="n">grp_name</span><span class="si">}</span><span class="s2">`&quot;</span>
                    <span class="p">)</span>
                <span class="n">grp_type</span> <span class="o">=</span> <span class="n">cls_attrs</span><span class="p">[</span><span class="n">grp_name</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grp_type</span><span class="p">,</span> <span class="n">CorgyMeta</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">grp_name</span><span class="si">}</span><span class="s2">` is not a `Corgy` class&quot;</span><span class="p">)</span>
                <span class="n">main_args_map</span><span class="p">[</span><span class="n">grp_name</span><span class="p">][</span><span class="n">arg_name_base</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg_val</span>

            <span class="k">elif</span> <span class="n">arg_name</span> <span class="ow">in</span> <span class="n">cls_attrs</span><span class="p">:</span>
                <span class="n">main_args_map</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg_val</span>

        <span class="k">for</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_type</span> <span class="ow">in</span> <span class="n">cls_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">arg_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">main_args_map</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">strict</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">):</span>
                    <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="n">arg_new_val</span> <span class="o">=</span> <span class="n">main_args_map</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg_type</span><span class="p">,</span> <span class="n">CorgyMeta</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg_new_val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">arg_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_type</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">arg_new_val</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">arg_obj</span><span class="o">.</span><span class="n">load_dict</span><span class="p">(</span><span class="n">arg_new_val</span><span class="p">,</span> <span class="n">try_cast</span><span class="p">,</span> <span class="n">strict</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">arg_new_val</span> <span class="o">=</span> <span class="n">check_val_type</span><span class="p">(</span>
                        <span class="n">arg_new_val</span><span class="p">,</span>
                        <span class="n">arg_type</span><span class="p">,</span>
                        <span class="n">try_cast</span><span class="p">,</span>
                        <span class="n">try_load_corgy_dicts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">self_type</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error setting `</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">`: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_new_val</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parse_from_cmdline</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span>
        <span class="n">parser</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArgumentParser</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">parser_args</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return an instance of the class parsed from command line arguments.</span>

<span class="sd">        Args:</span>
<span class="sd">            parser: An instance of `argparse.ArgumentParser` or `None`. If `None`, a new</span>
<span class="sd">                instance is created.</span>
<span class="sd">            defaults: A dictionary of default values for the attributes, passed to</span>
<span class="sd">                `add_args_to_parser`. Refer to the docs for `add_args_to_parser` for</span>
<span class="sd">                more details.</span>
<span class="sd">            parser_args: Arguments to be passed to `argparse.ArgumentParser()`. Ignored</span>
<span class="sd">                if `parser` is not None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ArgumentTypeError: Error parsing command line arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">parser</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;formatter_class&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parser_args</span><span class="p">:</span>
                <span class="n">parser_args</span><span class="p">[</span><span class="s2">&quot;formatter_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CorgyHelpFormatter</span>
            <span class="n">parser</span> <span class="o">=</span> <span class="n">ArgumentParser</span><span class="p">(</span><span class="o">**</span><span class="n">parser_args</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">add_args_to_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="n">defaults</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">try_cast</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">parse_from_toml</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span>
        <span class="n">toml_file</span><span class="p">:</span> <span class="n">IO</span><span class="p">[</span><span class="nb">bytes</span><span class="p">],</span>
        <span class="n">defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse an object of the class from a toml file.</span>

<span class="sd">        Args:</span>
<span class="sd">            toml_file: A file-like object containing the class attributes in toml.</span>
<span class="sd">            defaults: A dictionary of default values, overriding any values specified</span>
<span class="sd">                in the class.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TOMLDecodeError: Error parsing the toml file.</span>

<span class="sd">        Example::</span>

<span class="sd">            &gt;&gt;&gt; class G(Corgy):</span>
<span class="sd">            ...     x: int</span>
<span class="sd">            ...     y: Sequence[int]</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: str</span>
<span class="sd">            ...     g: G</span>

<span class="sd">            &gt;&gt;&gt; from io import BytesIO</span>
<span class="sd">            &gt;&gt;&gt; f = BytesIO(b&#39;&#39;&#39;</span>
<span class="sd">            ...     x = &#39;one&#39;</span>
<span class="sd">            ...     [g]</span>
<span class="sd">            ...     x = 1</span>
<span class="sd">            ...     y = [1, 2, 3]</span>
<span class="sd">            ... &#39;&#39;&#39;)</span>

<span class="sd">            &gt;&gt;&gt; A.parse_from_toml(f)  # doctest: +SKIP</span>
<span class="sd">            A(x=&#39;one&#39;, g=G(x=1, y=[1, 2, 3]))</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tomli</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="s2">&quot;tomllib&quot;</span> <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;tomli&quot;</span><span class="p">)</span>
        <span class="n">toml_data</span> <span class="o">=</span> <span class="n">tomli</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">toml_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">defaults</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_k</span><span class="p">,</span> <span class="n">_v</span> <span class="ow">in</span> <span class="n">defaults</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">_k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">toml_data</span><span class="p">:</span>
                    <span class="n">toml_data</span><span class="p">[</span><span class="n">_k</span><span class="p">]</span> <span class="o">=</span> <span class="n">_v</span>
        <span class="n">_parsers</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;__parsers&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_k</span><span class="p">,</span> <span class="n">_v</span> <span class="ow">in</span> <span class="n">toml_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">_k</span> <span class="ow">in</span> <span class="n">_parsers</span><span class="p">:</span>
                <span class="n">toml_data</span><span class="p">[</span><span class="n">_k</span><span class="p">]</span> <span class="o">=</span> <span class="n">_parsers</span><span class="p">[</span><span class="n">_k</span><span class="p">](</span><span class="n">_v</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">toml_data</span><span class="p">,</span> <span class="n">try_cast</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">freeze</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Freeze the object, preventing any further changes to attributes.</span>

<span class="sd">        Example::</span>

<span class="sd">            &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">            ...     x: int</span>
<span class="sd">            ...     y: int</span>

<span class="sd">            &gt;&gt;&gt; a = A(x=1, y=2)</span>
<span class="sd">            &gt;&gt;&gt; a.x = 2</span>
<span class="sd">            &gt;&gt;&gt; a.freeze()</span>
<span class="sd">            &gt;&gt;&gt; a.x = 3</span>
<span class="sd">            Traceback (most recent call last):</span>
<span class="sd">                ...</span>
<span class="sd">            TypeError: cannot set `x`: object is frozen</span>
<span class="sd">            &gt;&gt;&gt; del a.y</span>
<span class="sd">            Traceback (most recent call last):</span>
<span class="sd">                ...</span>
<span class="sd">            TypeError: cannot delete `y`: object is frozen</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">__frozen&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="corgy._corgy.Corgy.add_args_to_parser" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">add_args_to_parser</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#corgy._corgy.Corgy.add_args_to_parser" class="headerlink" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">add_args_to_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">name_prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flatten_subgrps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Add the class' <code>Corgy</code> attributes to the given parser.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>parser</code></td>
          <td>
                <code><span title="argparse._ActionsContainer">_ActionsContainer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Argument parser/group to which the attributes will be added.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name_prefix</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Prefix for argument names. Arguments will be named
<code>--&lt;name-prefix&gt;:&lt;attr-name&gt;</code>. If custom flags are present,
<code>--&lt;name-prefix&gt;:&lt;flag&gt;</code> will be used instead (one for each flag).</p>
            </div>
          </td>
          <td>
                <code>&#39;&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>flatten_subgrps</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to add sub-groups to the main parser instead of
creating argument groups. Note: sub-sub-groups are always added with
this argument set to <code>True</code>, since <code>argparse</code> in unable to properly
display nested group arguments.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>defaults</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Mapping">Mapping</span>[str, <span title="typing.Any">Any</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Optional mapping with default values for arguments. Any value
specified here will override default values specified in the class.
Values for groups can be specified either as <code>Corgy</code> instances, or as
individual values using the same syntax as for <code>Corgy.from_dict</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Type annotations control how attributes are added to the parser. A number of
special annotations are parsed and stripped from attribute types to determine
the parameters for calling <code>ArgumentParser.add_argument</code>. These special
annotations are described below.</p>
<p>Note: <code>add_args_to_parser</code> cannot be used if the type annotation for any
attribute of the class includes <code>Self</code>, unless a custom parser is defined
for such attributes. See docs for <code>corgyparser</code> on how to define custom
parsers.</p>
<p><em>Annotated</em>
<code>typing.Annotated</code> can be used to add a help message for the argument::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; import argparse
&gt;&gt;&gt; from argparse import ArgumentParser
&gt;&gt;&gt; from corgy import CorgyHelpFormatter

&gt;&gt;&gt; class A(Corgy):
...     x: Annotated[int, &quot;help for x&quot;]

&gt;&gt;&gt; parser = ArgumentParser(
...     formatter_class=CorgyHelpFormatter,
...     add_help=False,
...     usage=argparse.SUPPRESS,
... )

&gt;&gt;&gt; A.add_args_to_parser(parser)
&gt;&gt;&gt; parser.print_help()
options:
  --x int  help for x (optional)
</code></pre></div>
<p>This annotation can also be used to modify the parser flags for the argument. By
default, the attribute name is used, prefixed with <code>--</code>, and with <code>_</code> replaced
by <code>-</code>. If the custom flag does not have a leading <code>-</code>, a positional argument
will be created::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: Annotated[int, &quot;help for x&quot;, [&quot;-x&quot;, &quot;--ex&quot;]]
...     y: Annotated[int, &quot;help for y&quot;, [&quot;y&quot;]]

&gt;&gt;&gt; parser = ArgumentParser(
...     formatter_class=CorgyHelpFormatter,
...     add_help=False,
...     usage=argparse.SUPPRESS,
... )

&gt;&gt;&gt; A.add_args_to_parser(parser)
&gt;&gt;&gt; parser.print_help()
positional arguments:
  y int        help for y
&lt;BLANKLINE&gt;
options:
  -x/--ex int  help for x (optional)
</code></pre></div>
<p><code>Annotated</code> can accept multiple arguments, but only the first three are used
by <code>Corgy</code>. The first argument is the attribute type, the second is the help
message (which must be a string), and the third is a sequence of flags.</p>
<p><em>Required/NotRequired</em>
Every corgy attribute is either required or not required. The default status
depends on the class parameter <code>corgy_required_by_default</code> (<code>False</code> by default).
Attributes can also be explicitly marked as required or not required, and will
control whether the argument will be added with <code>required=True</code>::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from corgy import Required, NotRequired

&gt;&gt;&gt; class A(Corgy):
...     x: Required[int]
...     y: NotRequired[int]
...     z: int

&gt;&gt;&gt; parser = ArgumentParser(
...     formatter_class=CorgyHelpFormatter,
...     add_help=False,
...     usage=argparse.SUPPRESS,
... )

&gt;&gt;&gt; A.add_args_to_parser(parser)
&gt;&gt;&gt; parser.print_help()
options:
  --x int  (required)
  --y int  (optional)
  --z int  (optional)
</code></pre></div>
<p>Attributes which are not required, and don't have a default value are added
with <code>default=argparse.SUPPRESS</code>, and so will not be in the parsed namespace::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; parser.parse_args([&quot;--x&quot;, &quot;1&quot;, &quot;--y&quot;, &quot;2&quot;])
Namespace(x=1, y=2)
</code></pre></div>
<p><em>Optional</em>
Attributes marked with <code>typing.Optional</code> are allowed to be <code>None</code>. The
arguments for these attributes can be passed with no values (i.e. <code>--x</code>
instead of <code>--x=1</code> or <code>--x 1</code>) to indicate that the value should be <code>None</code>.</p>
<p>Note: Attributes with default values are also "optional" in the sense that
they can be omitted from the command line. However, they are not the same as
attributes marked with <code>Optional</code>, since the former are not allowed to be
<code>None</code>. Furthermore, <code>Required</code> <code>Optional</code> attributes without default values
<em>will</em> need to be passed on the command line (possibly with no values).</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: Required[Optional[int]]

&gt;&gt;&gt; parser = ArgumentParser()
&gt;&gt;&gt; A.add_args_to_parser(parser)
&gt;&gt;&gt; parser.parse_args([&quot;--x&quot;])
Namespace(x=None)
</code></pre></div>
<p><em>Boolean</em>
<code>bool</code> types (when not in a collection) are converted to a pair of options::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     arg: bool

&gt;&gt;&gt; parser = ArgumentParser(
...     formatter_class=CorgyHelpFormatter,
...     add_help=False,
...     usage=argparse.SUPPRESS,
... )

&gt;&gt;&gt; A.add_args_to_parser(parser)
&gt;&gt;&gt; parser.print_help()
options:
  --arg/--no-arg
</code></pre></div>
<p><em>Collection</em>
Collection types are added to the parser by setting <code>nargs</code>. The value for
<code>nargs</code> is determined by the collection type. Plain collections, such as
<code>Sequence[int]</code>, will be added with <code>nargs=*</code>; Non-empty collections, such as
<code>Sequence[int, ...]</code>, will be added with <code>nargs=+</code>; Finally, fixed-length
collections, such as <code>Sequence[int, int, int]</code>, will be added with <code>nargs</code> set
to the length of the collection.</p>
<p>In all cases, collection types can only be added to a parser if they are single
type. Heterogenous collections, such as <code>Sequence[int, str]</code> cannot be added,
and will raise <code>ValueError</code>. Untyped collections (e.g., <code>x: Sequence</code>), also
cannot be added.</p>
<p>Arguments for optional collections will also accept no values to indicate
<code>None</code>. Due to this, it is not possible to parse an empty collection for
an optional collection argument::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: Optional[Sequence[int]]
...     y: Sequence[int]

&gt;&gt;&gt; parser = ArgumentParser()
&gt;&gt;&gt; A.add_args_to_parser(parser)
&gt;&gt;&gt; parser.parse_args([&quot;--x&quot;, &quot;--y&quot;])
Namespace(x=None, y=[])
</code></pre></div>
<p><em>Literal</em>
For <code>Literal</code> types, the provided values are passed to the <code>choices</code> argument
of <code>ArgumentParser.add_argument</code>. All values must be of the same type, which
will be inferred from the type of the first value. If the first value has a
<code>__bases__</code> attribute, the type will be inferred as the first base type, and
all other choices must be subclasses of that type::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class T: ...
&gt;&gt;&gt; class T1(T): ...
&gt;&gt;&gt; class T2(T): ...

&gt;&gt;&gt; class A(Corgy):
...     x: Literal[T1, T2]

&gt;&gt;&gt; parser = ArgumentParser(
...     formatter_class=CorgyHelpFormatter,
...     add_help=False,
...     usage=argparse.SUPPRESS,
... )

&gt;&gt;&gt; A.add_args_to_parser(parser)
&gt;&gt;&gt; parser.print_help()
options:
  --x T  ({T1/T2} optional)
</code></pre></div>
<p>For types which specify choices by defining <code>__choices__</code>, the values are
passed to the <code>choices</code> argument as with <code>Literal</code>, but no type inference is
performed, and the base attribute type will be used as the argument type.</p>
<p><strong>Single-value Literals</strong>
A special case for <code>Literal</code> types is when there is only one choice. In this
case, the argument is added as a <code>store_const</code> action, with the value as the
<code>const</code> argument. A further special case is when the choice is <code>True/False</code>,
in which case the action is <code>store_true</code>/<code>store_false</code> respectively::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: Literal[True]
...     y: Literal[False]
...     z: Literal[42]

&gt;&gt;&gt; parser = ArgumentParser()
&gt;&gt;&gt; A.add_args_to_parser(parser)
&gt;&gt;&gt; parser.parse_args([&quot;--x&quot;])  # Note that `y` and `z` are absent
Namespace(x=True)
&gt;&gt;&gt; parser.parse_args([&quot;--y&quot;])
Namespace(y=False)
&gt;&gt;&gt; parser.parse_args([&quot;--z&quot;])
Namespace(z=42)
</code></pre></div>
<p>Note: This special case only applies to <code>Literal</code> types, and not types which
define <code>__choices__</code>.</p>
<p><em>Corgy</em>
Attributes which are themselves <code>Corgy</code> types are treated as argument groups.
Group arguments are added to the command line parser with the group attribute
name prefixed. Note that groups will ignore any custom flags when computing the
prefix; elements within the group will use custom flags, but because they are
prefixed with <code>--</code>, they will not be positional.</p>
<p>Example::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class G(Corgy):
...     x: int = 0
...     y: float

&gt;&gt;&gt; class A(Corgy):
...     x: int
...     g: G

&gt;&gt;&gt; parser = ArgumentParser(
...     formatter_class=CorgyHelpFormatter,
...     add_help=False,
...     usage=argparse.SUPPRESS,
... )

&gt;&gt;&gt; A.add_args_to_parser(parser)
&gt;&gt;&gt; parser.print_help()
options:
  --x int      (optional)
&lt;BLANKLINE&gt;
g:
  --g:x int    (default: 0)
  --g:y float  (optional)
</code></pre></div>
<p><strong>Custom parsers</strong></p>
<p>Attributes for which a custom parser is defined using <code>@corgyparser</code> will
be added with a custom action that will call the parser. Refer to the
documentation for <code>corgyparser</code> for details.</p>
<p><strong>Metavar</strong></p>
<p>This function will not explicitly pass a value for the <code>metavar</code> argument of
<code>ArgumentParser.add_argument</code>, unless an attribute's type defines <code>__metavar__</code>,
in which case, it will be passed as is. To change the metavar for attributes
with custom parsers, set the <code>metavar</code> argument of <code>corgyparser</code>.</p>

      <details class="quote">
        <summary>Source code in <code>corgy/_corgy.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">add_args_to_parser</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">parser</span><span class="p">:</span> <span class="n">_ActionsContainer</span><span class="p">,</span>
    <span class="n">name_prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="n">flatten_subgrps</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add the class&#39; `Corgy` attributes to the given parser.</span>

<span class="sd">    Args:</span>
<span class="sd">        parser: Argument parser/group to which the attributes will be added.</span>
<span class="sd">        name_prefix: Prefix for argument names. Arguments will be named</span>
<span class="sd">            `--&lt;name-prefix&gt;:&lt;attr-name&gt;`. If custom flags are present,</span>
<span class="sd">            `--&lt;name-prefix&gt;:&lt;flag&gt;` will be used instead (one for each flag).</span>
<span class="sd">        flatten_subgrps: Whether to add sub-groups to the main parser instead of</span>
<span class="sd">            creating argument groups. Note: sub-sub-groups are always added with</span>
<span class="sd">            this argument set to `True`, since `argparse` in unable to properly</span>
<span class="sd">            display nested group arguments.</span>
<span class="sd">        defaults: Optional mapping with default values for arguments. Any value</span>
<span class="sd">            specified here will override default values specified in the class.</span>
<span class="sd">            Values for groups can be specified either as `Corgy` instances, or as</span>
<span class="sd">            individual values using the same syntax as for `Corgy.from_dict`.</span>

<span class="sd">    Type annotations control how attributes are added to the parser. A number of</span>
<span class="sd">    special annotations are parsed and stripped from attribute types to determine</span>
<span class="sd">    the parameters for calling `ArgumentParser.add_argument`. These special</span>
<span class="sd">    annotations are described below.</span>

<span class="sd">    Note: `add_args_to_parser` cannot be used if the type annotation for any</span>
<span class="sd">    attribute of the class includes `Self`, unless a custom parser is defined</span>
<span class="sd">    for such attributes. See docs for `corgyparser` on how to define custom</span>
<span class="sd">    parsers.</span>

<span class="sd">    *Annotated*</span>
<span class="sd">    `typing.Annotated` can be used to add a help message for the argument::</span>

<span class="sd">        &gt;&gt;&gt; import argparse</span>
<span class="sd">        &gt;&gt;&gt; from argparse import ArgumentParser</span>
<span class="sd">        &gt;&gt;&gt; from corgy import CorgyHelpFormatter</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Annotated[int, &quot;help for x&quot;]</span>

<span class="sd">        &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">        ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">        ...     add_help=False,</span>
<span class="sd">        ...     usage=argparse.SUPPRESS,</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">        &gt;&gt;&gt; parser.print_help()</span>
<span class="sd">        options:</span>
<span class="sd">          --x int  help for x (optional)</span>

<span class="sd">    This annotation can also be used to modify the parser flags for the argument. By</span>
<span class="sd">    default, the attribute name is used, prefixed with `--`, and with `_` replaced</span>
<span class="sd">    by `-`. If the custom flag does not have a leading `-`, a positional argument</span>
<span class="sd">    will be created::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Annotated[int, &quot;help for x&quot;, [&quot;-x&quot;, &quot;--ex&quot;]]</span>
<span class="sd">        ...     y: Annotated[int, &quot;help for y&quot;, [&quot;y&quot;]]</span>

<span class="sd">        &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">        ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">        ...     add_help=False,</span>
<span class="sd">        ...     usage=argparse.SUPPRESS,</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">        &gt;&gt;&gt; parser.print_help()</span>
<span class="sd">        positional arguments:</span>
<span class="sd">          y int        help for y</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        options:</span>
<span class="sd">          -x/--ex int  help for x (optional)</span>

<span class="sd">    `Annotated` can accept multiple arguments, but only the first three are used</span>
<span class="sd">    by `Corgy`. The first argument is the attribute type, the second is the help</span>
<span class="sd">    message (which must be a string), and the third is a sequence of flags.</span>

<span class="sd">    *Required/NotRequired*</span>
<span class="sd">    Every corgy attribute is either required or not required. The default status</span>
<span class="sd">    depends on the class parameter `corgy_required_by_default` (`False` by default).</span>
<span class="sd">    Attributes can also be explicitly marked as required or not required, and will</span>
<span class="sd">    control whether the argument will be added with `required=True`::</span>

<span class="sd">        &gt;&gt;&gt; from corgy import Required, NotRequired</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Required[int]</span>
<span class="sd">        ...     y: NotRequired[int]</span>
<span class="sd">        ...     z: int</span>

<span class="sd">        &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">        ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">        ...     add_help=False,</span>
<span class="sd">        ...     usage=argparse.SUPPRESS,</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">        &gt;&gt;&gt; parser.print_help()</span>
<span class="sd">        options:</span>
<span class="sd">          --x int  (required)</span>
<span class="sd">          --y int  (optional)</span>
<span class="sd">          --z int  (optional)</span>

<span class="sd">    Attributes which are not required, and don&#39;t have a default value are added</span>
<span class="sd">    with `default=argparse.SUPPRESS`, and so will not be in the parsed namespace::</span>

<span class="sd">        &gt;&gt;&gt; parser.parse_args([&quot;--x&quot;, &quot;1&quot;, &quot;--y&quot;, &quot;2&quot;])</span>
<span class="sd">        Namespace(x=1, y=2)</span>

<span class="sd">    *Optional*</span>
<span class="sd">    Attributes marked with `typing.Optional` are allowed to be `None`. The</span>
<span class="sd">    arguments for these attributes can be passed with no values (i.e. `--x`</span>
<span class="sd">    instead of `--x=1` or `--x 1`) to indicate that the value should be `None`.</span>

<span class="sd">    Note: Attributes with default values are also &quot;optional&quot; in the sense that</span>
<span class="sd">    they can be omitted from the command line. However, they are not the same as</span>
<span class="sd">    attributes marked with `Optional`, since the former are not allowed to be</span>
<span class="sd">    `None`. Furthermore, `Required` `Optional` attributes without default values</span>
<span class="sd">    _will_ need to be passed on the command line (possibly with no values).</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Required[Optional[int]]</span>

<span class="sd">        &gt;&gt;&gt; parser = ArgumentParser()</span>
<span class="sd">        &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">        &gt;&gt;&gt; parser.parse_args([&quot;--x&quot;])</span>
<span class="sd">        Namespace(x=None)</span>

<span class="sd">    *Boolean*</span>
<span class="sd">    `bool` types (when not in a collection) are converted to a pair of options::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     arg: bool</span>

<span class="sd">        &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">        ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">        ...     add_help=False,</span>
<span class="sd">        ...     usage=argparse.SUPPRESS,</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">        &gt;&gt;&gt; parser.print_help()</span>
<span class="sd">        options:</span>
<span class="sd">          --arg/--no-arg</span>

<span class="sd">    *Collection*</span>
<span class="sd">    Collection types are added to the parser by setting `nargs`. The value for</span>
<span class="sd">    `nargs` is determined by the collection type. Plain collections, such as</span>
<span class="sd">    `Sequence[int]`, will be added with `nargs=*`; Non-empty collections, such as</span>
<span class="sd">    `Sequence[int, ...]`, will be added with `nargs=+`; Finally, fixed-length</span>
<span class="sd">    collections, such as `Sequence[int, int, int]`, will be added with `nargs` set</span>
<span class="sd">    to the length of the collection.</span>

<span class="sd">    In all cases, collection types can only be added to a parser if they are single</span>
<span class="sd">    type. Heterogenous collections, such as `Sequence[int, str]` cannot be added,</span>
<span class="sd">    and will raise `ValueError`. Untyped collections (e.g., `x: Sequence`), also</span>
<span class="sd">    cannot be added.</span>

<span class="sd">    Arguments for optional collections will also accept no values to indicate</span>
<span class="sd">    `None`. Due to this, it is not possible to parse an empty collection for</span>
<span class="sd">    an optional collection argument::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Optional[Sequence[int]]</span>
<span class="sd">        ...     y: Sequence[int]</span>

<span class="sd">        &gt;&gt;&gt; parser = ArgumentParser()</span>
<span class="sd">        &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">        &gt;&gt;&gt; parser.parse_args([&quot;--x&quot;, &quot;--y&quot;])</span>
<span class="sd">        Namespace(x=None, y=[])</span>

<span class="sd">    *Literal*</span>
<span class="sd">    For `Literal` types, the provided values are passed to the `choices` argument</span>
<span class="sd">    of `ArgumentParser.add_argument`. All values must be of the same type, which</span>
<span class="sd">    will be inferred from the type of the first value. If the first value has a</span>
<span class="sd">    `__bases__` attribute, the type will be inferred as the first base type, and</span>
<span class="sd">    all other choices must be subclasses of that type::</span>

<span class="sd">        &gt;&gt;&gt; class T: ...</span>
<span class="sd">        &gt;&gt;&gt; class T1(T): ...</span>
<span class="sd">        &gt;&gt;&gt; class T2(T): ...</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Literal[T1, T2]</span>

<span class="sd">        &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">        ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">        ...     add_help=False,</span>
<span class="sd">        ...     usage=argparse.SUPPRESS,</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">        &gt;&gt;&gt; parser.print_help()</span>
<span class="sd">        options:</span>
<span class="sd">          --x T  ({T1/T2} optional)</span>

<span class="sd">    For types which specify choices by defining `__choices__`, the values are</span>
<span class="sd">    passed to the `choices` argument as with `Literal`, but no type inference is</span>
<span class="sd">    performed, and the base attribute type will be used as the argument type.</span>

<span class="sd">    **Single-value Literals**</span>
<span class="sd">    A special case for `Literal` types is when there is only one choice. In this</span>
<span class="sd">    case, the argument is added as a `store_const` action, with the value as the</span>
<span class="sd">    `const` argument. A further special case is when the choice is `True/False`,</span>
<span class="sd">    in which case the action is `store_true`/`store_false` respectively::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Literal[True]</span>
<span class="sd">        ...     y: Literal[False]</span>
<span class="sd">        ...     z: Literal[42]</span>

<span class="sd">        &gt;&gt;&gt; parser = ArgumentParser()</span>
<span class="sd">        &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">        &gt;&gt;&gt; parser.parse_args([&quot;--x&quot;])  # Note that `y` and `z` are absent</span>
<span class="sd">        Namespace(x=True)</span>
<span class="sd">        &gt;&gt;&gt; parser.parse_args([&quot;--y&quot;])</span>
<span class="sd">        Namespace(y=False)</span>
<span class="sd">        &gt;&gt;&gt; parser.parse_args([&quot;--z&quot;])</span>
<span class="sd">        Namespace(z=42)</span>

<span class="sd">    Note: This special case only applies to `Literal` types, and not types which</span>
<span class="sd">    define `__choices__`.</span>

<span class="sd">    *Corgy*</span>
<span class="sd">    Attributes which are themselves `Corgy` types are treated as argument groups.</span>
<span class="sd">    Group arguments are added to the command line parser with the group attribute</span>
<span class="sd">    name prefixed. Note that groups will ignore any custom flags when computing the</span>
<span class="sd">    prefix; elements within the group will use custom flags, but because they are</span>
<span class="sd">    prefixed with `--`, they will not be positional.</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; class G(Corgy):</span>
<span class="sd">        ...     x: int = 0</span>
<span class="sd">        ...     y: float</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: int</span>
<span class="sd">        ...     g: G</span>

<span class="sd">        &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">        ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">        ...     add_help=False,</span>
<span class="sd">        ...     usage=argparse.SUPPRESS,</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">        &gt;&gt;&gt; parser.print_help()</span>
<span class="sd">        options:</span>
<span class="sd">          --x int      (optional)</span>
<span class="sd">        &lt;BLANKLINE&gt;</span>
<span class="sd">        g:</span>
<span class="sd">          --g:x int    (default: 0)</span>
<span class="sd">          --g:y float  (optional)</span>

<span class="sd">    **Custom parsers**</span>

<span class="sd">    Attributes for which a custom parser is defined using `@corgyparser` will</span>
<span class="sd">    be added with a custom action that will call the parser. Refer to the</span>
<span class="sd">    documentation for `corgyparser` for details.</span>

<span class="sd">    **Metavar**</span>

<span class="sd">    This function will not explicitly pass a value for the `metavar` argument of</span>
<span class="sd">    `ArgumentParser.add_argument`, unless an attribute&#39;s type defines `__metavar__`,</span>
<span class="sd">    in which case, it will be passed as is. To change the metavar for attributes</span>
<span class="sd">    with custom parsers, set the `metavar` argument of `corgyparser`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">base_parser</span> <span class="o">=</span> <span class="n">parser</span>
    <span class="n">base_defaults</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;__defaults&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">defaults</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">base_defaults</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span>

    <span class="c1"># Extract default values for group arguments specified individually using</span>
    <span class="c1"># the `&lt;group&gt;:&lt;var name&gt;` syntax.</span>
    <span class="n">group_arg_defaults</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_k</span><span class="p">,</span> <span class="n">_v</span> <span class="ow">in</span> <span class="n">base_defaults</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">_k</span><span class="p">:</span>
            <span class="n">_grp_name</span><span class="p">,</span> <span class="n">_var_name</span> <span class="o">=</span> <span class="n">_k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="n">group_arg_defaults</span><span class="p">[</span><span class="n">_grp_name</span><span class="p">][</span><span class="n">_var_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_v</span>
        <span class="k">elif</span> <span class="n">_k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;default value for unknown argument: `</span><span class="si">{</span><span class="n">_k</span><span class="si">}</span><span class="s2">`&quot;</span><span class="p">)</span>

    <span class="n">required_attrs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;__required&quot;</span><span class="p">)</span>
    <span class="n">custom_flags</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;__flags&quot;</span><span class="p">)</span>
    <span class="n">custom_parsers</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;__parsers&quot;</span><span class="p">)</span>

    <span class="nd">@dataclass</span>
    <span class="k">class</span> <span class="nc">_Arg</span><span class="p">:</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
        <span class="n">required</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">positional</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">dest</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">flags</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">help</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">nargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">action</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">argparse</span><span class="o">.</span><span class="n">Action</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">choices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">metavar</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">add_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">const</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">def</span> <span class="nf">get_add_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">custom_flags</span><span class="p">):</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dest&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;help&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;nargs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;action&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;choices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">base_defaults</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">base_defaults</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">required</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;required&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;default&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metavar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;metavar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metavar</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_type</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">const</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;const&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">const</span>

            <span class="k">return</span> <span class="n">kwargs</span>

        <span class="k">def</span> <span class="nf">process_optional</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_optional_type</span><span class="p">(</span><span class="n">type_</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">OptionalTypeAction</span>
                <span class="k">return</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">type_</span>

        <span class="k">def</span> <span class="nf">process_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="n">_col_type</span> <span class="o">=</span> <span class="n">get_concrete_collection_type</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_col_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="s2">&quot;__args__&quot;</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="ow">not</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span>
                    <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">TypeVar</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">` is a collection, but has no type arguments:&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot; use `</span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2">[&lt;types&gt;]&quot;</span>
                    <span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">Ellipsis</span><span class="p">:</span>
                    <span class="c1"># `...` is used to represent non-empty collections, e.g.,</span>
                    <span class="c1"># `Sequence[int, ...]`.</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Ensure single type.</span>
                    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">_a</span> <span class="o">!=</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">_a</span> <span class="ow">in</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">` has unsupported type `</span><span class="si">{</span><span class="n">type_</span><span class="si">}</span><span class="s2">`: only&quot;</span>
                            <span class="sa">f</span><span class="s2">&quot; single-type collections are supported&quot;</span>
                        <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">type_</span>

        <span class="k">def</span> <span class="nf">process_choices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
            <span class="n">_is_literal_type</span> <span class="o">=</span> <span class="n">is_literal_type</span><span class="p">(</span><span class="n">type_</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_is_literal_type</span><span class="p">:</span>
                <span class="c1"># Determine if the first choice has `__bases__`, in which case</span>
                <span class="c1"># the first base class is the type for the argument.</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">c0_type</span> <span class="o">=</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="n">c0_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">f_check_type</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="nb">isinstance</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">f_check_type</span> <span class="o">=</span> <span class="nb">issubclass</span>

                <span class="c1"># All choices must be of the same type.</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="ow">not</span> <span class="n">f_check_type</span><span class="p">(</span><span class="n">_a</span><span class="p">,</span> <span class="n">c0_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">_a</span> <span class="ow">in</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;choices for `</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">` not all of type `</span><span class="si">{</span><span class="n">c0_type</span><span class="si">}</span><span class="s2">`: &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">type_</span><span class="o">.</span><span class="n">__args__</span><span class="si">}</span><span class="s2">`&quot;</span>
                    <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="n">type_</span><span class="o">.</span><span class="n">__args__</span>

                <span class="c1"># Convert single choice attributes to `store_*` actions.</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nargs</span> <span class="ow">is</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="p">):</span>
                    <span class="n">_choice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">_choice</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">_StoreTrueAction</span>
                    <span class="k">elif</span> <span class="n">_choice</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">_StoreFalseAction</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">_StoreConstAction</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">const</span> <span class="o">=</span> <span class="n">_choice</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="n">c0_type</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">type_</span><span class="p">,</span> <span class="s2">&quot;__choices__&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="n">type_</span><span class="o">.</span><span class="n">__choices__</span>

            <span class="k">return</span> <span class="n">type_</span>

    <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">var_type</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">attrs</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">var_arg</span> <span class="o">=</span> <span class="n">_Arg</span><span class="p">(</span><span class="n">var_name</span><span class="p">)</span>
        <span class="n">var_arg</span><span class="o">.</span><span class="n">help</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span> <span class="n">var_name</span>
        <span class="p">)</span><span class="o">.</span><span class="vm">__doc__</span>  <span class="c1"># doc is stored in the property</span>
        <span class="n">var_arg</span><span class="o">.</span><span class="n">required</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">var_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">base_defaults</span> <span class="ow">and</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">required_attrs</span>
        <span class="p">)</span>

        <span class="c1"># Determine add flags.</span>
        <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">custom_flags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">var_name</span><span class="p">,</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;--</span><span class="si">{</span><span class="n">var_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">name_prefix</span><span class="p">:</span>
            <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;--</span><span class="si">{</span><span class="n">name_prefix</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">flag</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span>
            <span class="p">]</span>
            <span class="n">var_arg</span><span class="o">.</span><span class="n">dest</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name_prefix</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">var_arg</span><span class="o">.</span><span class="n">dest</span> <span class="o">=</span> <span class="n">var_name</span>

        <span class="c1"># Determine if argument is positional.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">_flag</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_flag</span> <span class="ow">in</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span><span class="p">):</span>
            <span class="c1"># Note: the flags cannot be passed to `add_argument` with `dest` set</span>
            <span class="c1"># to `var_name` since `argparse` will raise an error for passing `dest`</span>
            <span class="c1"># twice (for positional arguments, `argparse` uses the flag to infer the</span>
            <span class="c1"># `dest`).</span>
            <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="p">[</span><span class="n">var_name</span><span class="p">]</span>
            <span class="n">var_arg</span><span class="o">.</span><span class="n">positional</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="n">_flag</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">_flag</span> <span class="ow">in</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span><span class="p">):</span>
            <span class="n">var_arg</span><span class="o">.</span><span class="n">positional</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;inconsistent positional/optional flags for </span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2">: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1">###################################################################</span>
        <span class="c1"># Check if the variable has a custom parser.</span>
        <span class="k">if</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">custom_parsers</span><span class="p">:</span>
            <span class="n">_var_parser</span> <span class="o">=</span> <span class="n">custom_parsers</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span>
            <span class="n">_var_base_type</span> <span class="o">=</span> <span class="n">var_type</span>
            <span class="c1"># Extract choices if present.</span>
            <span class="k">if</span> <span class="n">is_literal_type</span><span class="p">(</span><span class="n">var_type</span><span class="p">):</span>
                <span class="n">_var_choices</span> <span class="o">=</span> <span class="n">var_type</span><span class="o">.</span><span class="n">__args__</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">_var_base_type</span> <span class="o">=</span> <span class="n">_var_choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="n">_var_base_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">_var_choices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">var_type</span><span class="p">,</span> <span class="s2">&quot;__choices__&quot;</span><span class="p">):</span>
                <span class="n">_var_choices</span> <span class="o">=</span> <span class="n">var_type</span><span class="o">.</span><span class="n">__choices__</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_var_choices</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">var_arg</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
                <span class="n">CorgyParserAction</span><span class="p">,</span> <span class="n">_var_parser</span><span class="p">,</span> <span class="n">_var_choices</span>  <span class="c1"># type: ignore</span>
            <span class="p">)</span>
            <span class="n">var_arg</span><span class="o">.</span><span class="n">add_type</span> <span class="o">=</span> <span class="nb">str</span>
            <span class="n">var_arg</span><span class="o">.</span><span class="n">nargs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">_var_parser</span><span class="p">,</span> <span class="s2">&quot;__nargs__&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">var_arg</span><span class="o">.</span><span class="n">metavar</span> <span class="o">=</span> <span class="n">_var_parser</span><span class="o">.</span><span class="n">__metavar__</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">var_arg</span><span class="o">.</span><span class="n">metavar</span> <span class="o">=</span> <span class="n">_var_base_type</span><span class="o">.</span><span class="n">__metavar__</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="o">*</span><span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="o">**</span><span class="n">var_arg</span><span class="o">.</span><span class="n">get_add_kwargs</span><span class="p">())</span>
            <span class="k">continue</span>

        <span class="c1">###################################################################</span>
        <span class="c1"># Check if the variable is also `Corgy` type.</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">var_type</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">type</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
            <span class="c1"># Create an argument group using `&lt;var_type&gt;`.</span>
            <span class="c1"># If there is a default value, pass it using `**defaults`.</span>
            <span class="k">if</span> <span class="n">var_name</span> <span class="ow">in</span> <span class="n">base_defaults</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">grp_defaults</span> <span class="o">=</span> <span class="n">base_defaults</span><span class="p">[</span><span class="n">var_name</span><span class="p">]</span><span class="o">.</span><span class="n">as_dict</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;default value for `</span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2">` is not a `Corgy` instance&quot;</span>
                    <span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">grp_defaults</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c1"># Update defaults with any values specified individually.</span>
            <span class="n">grp_defaults</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">group_arg_defaults</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="p">{}))</span>

            <span class="n">grp_parser</span><span class="p">:</span> <span class="n">_ActionsContainer</span>
            <span class="k">if</span> <span class="n">flatten_subgrps</span><span class="p">:</span>
                <span class="n">grp_parser</span> <span class="o">=</span> <span class="n">base_parser</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">grp_parser</span> <span class="o">=</span> <span class="n">base_parser</span><span class="o">.</span><span class="n">add_argument_group</span><span class="p">(</span>
                    <span class="n">var_arg</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">help</span>
                <span class="p">)</span>
            <span class="n">var_type</span><span class="o">.</span><span class="n">add_args_to_parser</span><span class="p">(</span>
                <span class="n">grp_parser</span><span class="p">,</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">grp_defaults</span>
            <span class="p">)</span>
            <span class="k">continue</span>

        <span class="c1">###################################################################</span>
        <span class="c1"># Check if the variable is boolean. Boolean variables are converted to</span>
        <span class="c1"># `--&lt;var-name&gt;`/`--no-&lt;var-name&gt;` arguments (if not positional).</span>
        <span class="k">if</span> <span class="n">var_type</span> <span class="ow">is</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="n">var_arg</span><span class="o">.</span><span class="n">add_type</span> <span class="o">=</span> <span class="nb">bool</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">positional</span><span class="p">:</span>
                <span class="n">var_arg</span><span class="o">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">BooleanOptionalAction</span>
            <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="o">*</span><span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="o">**</span><span class="n">var_arg</span><span class="o">.</span><span class="n">get_add_kwargs</span><span class="p">())</span>
            <span class="k">continue</span>

        <span class="c1">###################################################################</span>
        <span class="c1"># Process annotations.</span>
        <span class="n">var_base_type</span> <span class="o">=</span> <span class="n">var_type</span>
        <span class="n">var_base_type</span> <span class="o">=</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">process_optional</span><span class="p">(</span><span class="n">var_base_type</span><span class="p">)</span>
        <span class="n">var_base_type</span> <span class="o">=</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">process_collection</span><span class="p">(</span><span class="n">var_base_type</span><span class="p">)</span>
        <span class="n">var_base_type</span> <span class="o">=</span> <span class="n">var_arg</span><span class="o">.</span><span class="n">process_choices</span><span class="p">(</span><span class="n">var_base_type</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">var_base_type</span> <span class="ow">is</span> <span class="n">Self</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;&#39;add_args_to_parser&#39; cannot be used with &#39;Self&#39; type present&quot;</span>
            <span class="p">)</span>

        <span class="n">var_arg</span><span class="o">.</span><span class="n">metavar</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">var_base_type</span><span class="p">,</span> <span class="s2">&quot;__metavar__&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">var_arg</span><span class="o">.</span><span class="n">add_type</span> <span class="o">=</span> <span class="n">var_base_type</span>
        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="o">*</span><span class="n">var_arg</span><span class="o">.</span><span class="n">flags</span><span class="p">,</span> <span class="o">**</span><span class="n">var_arg</span><span class="o">.</span><span class="n">get_add_kwargs</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="corgy._corgy.Corgy.as_dict" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">as_dict</span>


<a href="#corgy._corgy.Corgy.as_dict" class="headerlink" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">as_dict</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the object as a dictionary.</p>
<p>The returned dictionary maps attribute names to their values. Unset attributes
are omitted, unless they have default values.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>recursive</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether to recursively call <code>as_dict</code> on attributes which are
<code>Corgy</code> instances. Otherwise, they are returned as is.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>flatten</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether to flatten group arguments into <code>:</code> separated strings.
Only takes effect if <code>recursive</code> is <code>True</code>.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Examples::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class G(Corgy):
...     x: int

&gt;&gt;&gt; g = G(x=1)
&gt;&gt;&gt; g.as_dict()
{&#39;x&#39;: 1}

&gt;&gt;&gt; class A(Corgy):
...     x: str
...     g: G

&gt;&gt;&gt; a = A(x=&quot;one&quot;, g=g)
&gt;&gt;&gt; a.as_dict(recursive=False)
{&#39;x&#39;: &#39;one&#39;, &#39;g&#39;: G(x=1)}
&gt;&gt;&gt; a.as_dict()
{&#39;x&#39;: &#39;one&#39;, &#39;g&#39;: {&#39;x&#39;: 1}}
&gt;&gt;&gt; a.as_dict(flatten=True)
{&#39;x&#39;: &#39;one&#39;, &#39;g:x&#39;: 1}
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>corgy/_corgy.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">flatten</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the object as a dictionary.</span>

<span class="sd">    The returned dictionary maps attribute names to their values. Unset attributes</span>
<span class="sd">    are omitted, unless they have default values.</span>

<span class="sd">    Args:</span>
<span class="sd">        recursive: whether to recursively call `as_dict` on attributes which are</span>
<span class="sd">            `Corgy` instances. Otherwise, they are returned as is.</span>
<span class="sd">        flatten: whether to flatten group arguments into `:` separated strings.</span>
<span class="sd">            Only takes effect if `recursive` is `True`.</span>

<span class="sd">    Examples::</span>

<span class="sd">        &gt;&gt;&gt; class G(Corgy):</span>
<span class="sd">        ...     x: int</span>

<span class="sd">        &gt;&gt;&gt; g = G(x=1)</span>
<span class="sd">        &gt;&gt;&gt; g.as_dict()</span>
<span class="sd">        {&#39;x&#39;: 1}</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: str</span>
<span class="sd">        ...     g: G</span>

<span class="sd">        &gt;&gt;&gt; a = A(x=&quot;one&quot;, g=g)</span>
<span class="sd">        &gt;&gt;&gt; a.as_dict(recursive=False)</span>
<span class="sd">        {&#39;x&#39;: &#39;one&#39;, &#39;g&#39;: G(x=1)}</span>
<span class="sd">        &gt;&gt;&gt; a.as_dict()</span>
<span class="sd">        {&#39;x&#39;: &#39;one&#39;, &#39;g&#39;: {&#39;x&#39;: 1}}</span>
<span class="sd">        &gt;&gt;&gt; a.as_dict(flatten=True)</span>
<span class="sd">        {&#39;x&#39;: &#39;one&#39;, &#39;g:x&#39;: 1}</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">dictify_corgys</span><span class="p">(</span><span class="n">_val</span><span class="p">):</span>
        <span class="n">_coll_type</span> <span class="o">=</span> <span class="n">get_concrete_collection_type</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">_val</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">_coll_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_cast_type</span> <span class="o">=</span> <span class="n">_coll_type</span> <span class="k">if</span> <span class="n">_coll_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">AbstractSequence</span> <span class="k">else</span> <span class="nb">list</span>
            <span class="k">return</span> <span class="n">_cast_type</span><span class="p">(</span>  <span class="c1"># pylint: disable=abstract-class-instantiated</span>
                <span class="p">[</span><span class="n">dictify_corgys</span><span class="p">(</span><span class="n">_val_part</span><span class="p">)</span> <span class="k">for</span> <span class="n">_val_part</span> <span class="ow">in</span> <span class="n">_val</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_val</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">CorgyMeta</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">_val</span><span class="o">.</span><span class="n">as_dict</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="n">flatten</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_val</span>

    <span class="n">self_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">attr_val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">recursive</span><span class="p">:</span>
            <span class="n">attr_val</span> <span class="o">=</span> <span class="n">dictify_corgys</span><span class="p">(</span><span class="n">attr_val</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">flatten</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">attr_type</span><span class="p">,</span> <span class="n">CorgyMeta</span><span class="p">)</span> <span class="ow">or</span> <span class="n">attr_type</span> <span class="ow">is</span> <span class="n">Self</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">_k</span><span class="p">,</span> <span class="n">_v</span> <span class="ow">in</span> <span class="n">attr_val</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">_flat_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">_k</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="n">self_dict</span><span class="p">[</span><span class="n">_flat_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_v</span>
                <span class="k">continue</span>

        <span class="n">self_dict</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">attr_val</span>

    <span class="k">return</span> <span class="n">self_dict</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="corgy._corgy.Corgy.attrs" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">attrs</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#corgy._corgy.Corgy.attrs" class="headerlink" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">attrs</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a dictionary mapping attributes of the class to their types.</p>
<p>Example::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: Annotated[int, &quot;x&quot;]
...     y: Sequence[str]

&gt;&gt;&gt; A.attrs()
{&#39;x&#39;: &lt;class &#39;int&#39;&gt;, &#39;y&#39;: typing.Sequence[str]}
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>corgy/_corgy.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">attrs</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a dictionary mapping attributes of the class to their types.</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: Annotated[int, &quot;x&quot;]</span>
<span class="sd">        ...     y: Sequence[str]</span>

<span class="sd">        &gt;&gt;&gt; A.attrs()</span>
<span class="sd">        {&#39;x&#39;: &lt;class &#39;int&#39;&gt;, &#39;y&#39;: typing.Sequence[str]}</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="n">_attr</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">_attr</span><span class="p">)</span><span class="o">.</span><span class="n">fget</span><span class="o">.</span><span class="vm">__annotations__</span><span class="p">[</span><span class="s2">&quot;return&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">_attr</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__annotations__</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="corgy._corgy.Corgy.freeze" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">freeze</span>


<a href="#corgy._corgy.Corgy.freeze" class="headerlink" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">freeze</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Freeze the object, preventing any further changes to attributes.</p>
<p>Example::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: int
...     y: int

&gt;&gt;&gt; a = A(x=1, y=2)
&gt;&gt;&gt; a.x = 2
&gt;&gt;&gt; a.freeze()
&gt;&gt;&gt; a.x = 3
Traceback (most recent call last):
    ...
TypeError: cannot set `x`: object is frozen
&gt;&gt;&gt; del a.y
Traceback (most recent call last):
    ...
TypeError: cannot delete `y`: object is frozen
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>corgy/_corgy.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">freeze</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Freeze the object, preventing any further changes to attributes.</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: int</span>
<span class="sd">        ...     y: int</span>

<span class="sd">        &gt;&gt;&gt; a = A(x=1, y=2)</span>
<span class="sd">        &gt;&gt;&gt; a.x = 2</span>
<span class="sd">        &gt;&gt;&gt; a.freeze()</span>
<span class="sd">        &gt;&gt;&gt; a.x = 3</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        TypeError: cannot set `x`: object is frozen</span>
<span class="sd">        &gt;&gt;&gt; del a.y</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        TypeError: cannot delete `y`: object is frozen</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">__frozen&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="corgy._corgy.Corgy.from_dict" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">from_dict</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#corgy._corgy.Corgy.from_dict" class="headerlink" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">try_cast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a new instance of the class using a dictionary.</p>
<p>This is roughly equivalent to <code>cls(**d)</code>, with the main exception being that
groups can be specified as dictionaries themselves, and will be processed
recursively.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>d</code></td>
          <td>
                <code><span title="typing.Mapping">Mapping</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary to create the instance from.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>try_cast</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to try and cast values which don't match attribute types.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class G(Corgy):
...     x: int

&gt;&gt;&gt; class A(Corgy):
...     x: str
...     g: G

&gt;&gt;&gt; A.from_dict({&quot;x&quot;: &quot;one&quot;, &quot;g&quot;: G(x=1)})
A(x=&#39;one&#39;, g=G(x=1))
&gt;&gt;&gt; A.from_dict({&quot;x&quot;: &quot;one&quot;, &quot;g&quot;: {&quot;x&quot;: 1}})
A(x=&#39;one&#39;, g=G(x=1))
&gt;&gt;&gt; A.from_dict({&quot;x&quot;: &quot;one&quot;, &quot;g&quot;: {&quot;x&quot;: &quot;1&quot;}}, try_cast=True)
A(x=&#39;one&#39;, g=G(x=1))
&gt;&gt;&gt; G.from_dict({&quot;x&quot;: &quot;1&quot;})
Traceback (most recent call last):
    ...
ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;int&#39;&gt;&#39;: &#39;1&#39;
</code></pre></div>
<p>Group attributes can also be passed directly in the dictionary by prefixing
their names with the group name and a colon::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; A.from_dict({&quot;x&quot;: &quot;one&quot;, &quot;g:x&quot;: 1})
A(x=&#39;one&#39;, g=G(x=1))

&gt;&gt;&gt; class B(Corgy):
...     x: float
...     a: A

&gt;&gt;&gt; B.from_dict({&quot;x&quot;: 1.1, &quot;a:x&quot;: &quot;one&quot;, &quot;a:g:x&quot;: 1})
B(x=1.1, a=A(x=&#39;one&#39;, g=G(x=1)))
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>corgy/_corgy.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span> <span class="n">d</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">try_cast</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a new instance of the class using a dictionary.</span>

<span class="sd">    This is roughly equivalent to `cls(**d)`, with the main exception being that</span>
<span class="sd">    groups can be specified as dictionaries themselves, and will be processed</span>
<span class="sd">    recursively.</span>

<span class="sd">    Args:</span>
<span class="sd">        d: Dictionary to create the instance from.</span>
<span class="sd">        try_cast: Whether to try and cast values which don&#39;t match attribute types.</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; class G(Corgy):</span>
<span class="sd">        ...     x: int</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: str</span>
<span class="sd">        ...     g: G</span>

<span class="sd">        &gt;&gt;&gt; A.from_dict({&quot;x&quot;: &quot;one&quot;, &quot;g&quot;: G(x=1)})</span>
<span class="sd">        A(x=&#39;one&#39;, g=G(x=1))</span>
<span class="sd">        &gt;&gt;&gt; A.from_dict({&quot;x&quot;: &quot;one&quot;, &quot;g&quot;: {&quot;x&quot;: 1}})</span>
<span class="sd">        A(x=&#39;one&#39;, g=G(x=1))</span>
<span class="sd">        &gt;&gt;&gt; A.from_dict({&quot;x&quot;: &quot;one&quot;, &quot;g&quot;: {&quot;x&quot;: &quot;1&quot;}}, try_cast=True)</span>
<span class="sd">        A(x=&#39;one&#39;, g=G(x=1))</span>
<span class="sd">        &gt;&gt;&gt; G.from_dict({&quot;x&quot;: &quot;1&quot;})</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;int&#39;&gt;&#39;: &#39;1&#39;</span>

<span class="sd">    Group attributes can also be passed directly in the dictionary by prefixing</span>
<span class="sd">    their names with the group name and a colon::</span>

<span class="sd">        &gt;&gt;&gt; A.from_dict({&quot;x&quot;: &quot;one&quot;, &quot;g:x&quot;: 1})</span>
<span class="sd">        A(x=&#39;one&#39;, g=G(x=1))</span>

<span class="sd">        &gt;&gt;&gt; class B(Corgy):</span>
<span class="sd">        ...     x: float</span>
<span class="sd">        ...     a: A</span>

<span class="sd">        &gt;&gt;&gt; B.from_dict({&quot;x&quot;: 1.1, &quot;a:x&quot;: &quot;one&quot;, &quot;a:g:x&quot;: 1})</span>
<span class="sd">        B(x=1.1, a=A(x=&#39;one&#39;, g=G(x=1)))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">main_args_map</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">grp_args_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">cls_attrs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">attrs</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_val</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">arg_name</span><span class="p">:</span>
            <span class="n">grp_name</span><span class="p">,</span> <span class="n">arg_name_base</span> <span class="o">=</span> <span class="n">arg_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">grp_name</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;invalid argument `</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">`: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="bp">cls</span><span class="si">}</span><span class="s2">` has no group named `</span><span class="si">{</span><span class="n">grp_name</span><span class="si">}</span><span class="s2">`&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">grp_name</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;conflicting arguments: `</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">` and `</span><span class="si">{</span><span class="n">grp_name</span><span class="si">}</span><span class="s2">`&quot;</span>
                <span class="p">)</span>
            <span class="n">grp_type</span> <span class="o">=</span> <span class="n">cls_attrs</span><span class="p">[</span><span class="n">grp_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grp_type</span><span class="p">,</span> <span class="n">CorgyMeta</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">grp_name</span><span class="si">}</span><span class="s2">` is not a `Corgy` class&quot;</span><span class="p">)</span>
            <span class="n">grp_args_map</span><span class="p">[</span><span class="n">grp_name</span><span class="p">][</span><span class="n">arg_name_base</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg_val</span>

        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">):</span>
            <span class="n">arg_type</span> <span class="o">=</span> <span class="n">cls_attrs</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg_type</span><span class="p">,</span> <span class="n">CorgyMeta</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg_val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">grp_args_map</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg_val</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">main_args_map</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg_val</span>

    <span class="k">for</span> <span class="n">grp_name</span><span class="p">,</span> <span class="n">grp_args</span> <span class="ow">in</span> <span class="n">grp_args_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">grp_type</span> <span class="o">=</span> <span class="n">cls_attrs</span><span class="p">[</span><span class="n">grp_name</span><span class="p">]</span>
        <span class="n">main_args_map</span><span class="p">[</span><span class="n">grp_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">grp_type</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">grp_args</span><span class="p">,</span> <span class="n">try_cast</span><span class="p">)</span>

    <span class="n">cls_attrs</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">attrs</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_val</span> <span class="ow">in</span> <span class="n">main_args_map</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">arg_name</span> <span class="ow">in</span> <span class="n">cls_attrs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">main_args_map</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">check_val_type</span><span class="p">(</span>
                    <span class="n">arg_val</span><span class="p">,</span>
                    <span class="n">cls_attrs</span><span class="p">[</span><span class="n">arg_name</span><span class="p">],</span>
                    <span class="n">try_cast</span><span class="p">,</span>
                    <span class="n">try_load_corgy_dicts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">self_type</span><span class="o">=</span><span class="bp">cls</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error setting `</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">`: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">main_args_map</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="corgy._corgy.Corgy.load_dict" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">load_dict</span>


<a href="#corgy._corgy.Corgy.load_dict" class="headerlink" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">load_dict</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">try_cast</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Load a dictionary into an instance of the class.</p>
<p>Previous attributes are overwritten. Sub-dictionaries will be parsed
recursively if the corresponding attribute already exists, else will be parsed
using <code>from_dict</code>. As with <code>from_dict</code>, items in the dictionary without
corresponding attributes are ignored.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>d</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dictionary to load.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>try_cast</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to try and cast values which don't match attribute types.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>strict</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>True</code>, attributes with existing values that are not in the
dictionary will be unset.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: int
...     y: str
&gt;&gt;&gt; a = A(x=1)
&gt;&gt;&gt; _i = id(a)
&gt;&gt;&gt; a.load_dict({&quot;y&quot;: &quot;two&quot;})
&gt;&gt;&gt; a
A(x=1, y=&#39;two&#39;)
&gt;&gt;&gt; _i == id(a)
True
&gt;&gt;&gt; a.load_dict({&quot;y&quot;: &quot;three&quot;}, strict=True)
&gt;&gt;&gt; a
A(y=&#39;three&#39;)
&gt;&gt;&gt; _i == id(a)
True
&gt;&gt;&gt; a = A()
&gt;&gt;&gt; a.load_dict({&quot;x&quot;: &quot;1&quot;})
Traceback (most recent call last):
    ...
ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;int&#39;&gt;&#39;: &#39;1&#39;
&gt;&gt;&gt; a.load_dict({&quot;x&quot;: &quot;1&quot;}, try_cast=True)
&gt;&gt;&gt; a
A(x=1)
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>corgy/_corgy.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_dict</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">try_cast</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a dictionary into an instance of the class.</span>

<span class="sd">    Previous attributes are overwritten. Sub-dictionaries will be parsed</span>
<span class="sd">    recursively if the corresponding attribute already exists, else will be parsed</span>
<span class="sd">    using `from_dict`. As with `from_dict`, items in the dictionary without</span>
<span class="sd">    corresponding attributes are ignored.</span>

<span class="sd">    Args:</span>
<span class="sd">        d: Dictionary to load.</span>
<span class="sd">        try_cast: Whether to try and cast values which don&#39;t match attribute types.</span>
<span class="sd">        strict: If `True`, attributes with existing values that are not in the</span>
<span class="sd">            dictionary will be unset.</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: int</span>
<span class="sd">        ...     y: str</span>
<span class="sd">        &gt;&gt;&gt; a = A(x=1)</span>
<span class="sd">        &gt;&gt;&gt; _i = id(a)</span>
<span class="sd">        &gt;&gt;&gt; a.load_dict({&quot;y&quot;: &quot;two&quot;})</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        A(x=1, y=&#39;two&#39;)</span>
<span class="sd">        &gt;&gt;&gt; _i == id(a)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; a.load_dict({&quot;y&quot;: &quot;three&quot;}, strict=True)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        A(y=&#39;three&#39;)</span>
<span class="sd">        &gt;&gt;&gt; _i == id(a)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; a = A()</span>
<span class="sd">        &gt;&gt;&gt; a.load_dict({&quot;x&quot;: &quot;1&quot;})</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">            ...</span>
<span class="sd">        ValueError: error setting `x`: invalid value for type &#39;&lt;class &#39;int&#39;&gt;&#39;: &#39;1&#39;</span>
<span class="sd">        &gt;&gt;&gt; a.load_dict({&quot;x&quot;: &quot;1&quot;}, try_cast=True)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        A(x=1)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">main_args_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="n">cls_attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_val</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">arg_name</span><span class="p">:</span>
            <span class="n">grp_name</span><span class="p">,</span> <span class="n">arg_name_base</span> <span class="o">=</span> <span class="n">arg_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">grp_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cls_attrs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;invalid argument `</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">`: &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="si">}</span><span class="s2">` has no group named `</span><span class="si">{</span><span class="n">grp_name</span><span class="si">}</span><span class="s2">`&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">grp_name</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;conflicting arguments: `</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">` and `</span><span class="si">{</span><span class="n">grp_name</span><span class="si">}</span><span class="s2">`&quot;</span>
                <span class="p">)</span>
            <span class="n">grp_type</span> <span class="o">=</span> <span class="n">cls_attrs</span><span class="p">[</span><span class="n">grp_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">grp_type</span><span class="p">,</span> <span class="n">CorgyMeta</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`</span><span class="si">{</span><span class="n">grp_name</span><span class="si">}</span><span class="s2">` is not a `Corgy` class&quot;</span><span class="p">)</span>
            <span class="n">main_args_map</span><span class="p">[</span><span class="n">grp_name</span><span class="p">][</span><span class="n">arg_name_base</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg_val</span>

        <span class="k">elif</span> <span class="n">arg_name</span> <span class="ow">in</span> <span class="n">cls_attrs</span><span class="p">:</span>
            <span class="n">main_args_map</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg_val</span>

    <span class="k">for</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_type</span> <span class="ow">in</span> <span class="n">cls_attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">arg_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">main_args_map</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">strict</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">):</span>
                <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="n">arg_new_val</span> <span class="o">=</span> <span class="n">main_args_map</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg_type</span><span class="p">,</span> <span class="n">CorgyMeta</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg_new_val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">arg_obj</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_type</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">arg_new_val</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arg_obj</span><span class="o">.</span><span class="n">load_dict</span><span class="p">(</span><span class="n">arg_new_val</span><span class="p">,</span> <span class="n">try_cast</span><span class="p">,</span> <span class="n">strict</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">arg_new_val</span> <span class="o">=</span> <span class="n">check_val_type</span><span class="p">(</span>
                    <span class="n">arg_new_val</span><span class="p">,</span>
                    <span class="n">arg_type</span><span class="p">,</span>
                    <span class="n">try_cast</span><span class="p">,</span>
                    <span class="n">try_load_corgy_dicts</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">self_type</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;error setting `</span><span class="si">{</span><span class="n">arg_name</span><span class="si">}</span><span class="s2">`: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="kc">None</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_new_val</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="corgy._corgy.Corgy.parse_from_cmdline" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">parse_from_cmdline</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#corgy._corgy.Corgy.parse_from_cmdline" class="headerlink" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">parse_from_cmdline</span><span class="p">(</span><span class="n">parser</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">parser_args</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return an instance of the class parsed from command line arguments.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>parser</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="argparse.ArgumentParser">ArgumentParser</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An instance of <code>argparse.ArgumentParser</code> or <code>None</code>. If <code>None</code>, a new
instance is created.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>defaults</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Mapping">Mapping</span>[str, <span title="typing.Any">Any</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary of default values for the attributes, passed to
<code>add_args_to_parser</code>. Refer to the docs for <code>add_args_to_parser</code> for
more details.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>parser_args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arguments to be passed to <code>argparse.ArgumentParser()</code>. Ignored
if <code>parser</code> is not None.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>ArgumentTypeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Error parsing command line arguments.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>corgy/_corgy.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">parse_from_cmdline</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span>
    <span class="n">parser</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArgumentParser</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">parser_args</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an instance of the class parsed from command line arguments.</span>

<span class="sd">    Args:</span>
<span class="sd">        parser: An instance of `argparse.ArgumentParser` or `None`. If `None`, a new</span>
<span class="sd">            instance is created.</span>
<span class="sd">        defaults: A dictionary of default values for the attributes, passed to</span>
<span class="sd">            `add_args_to_parser`. Refer to the docs for `add_args_to_parser` for</span>
<span class="sd">            more details.</span>
<span class="sd">        parser_args: Arguments to be passed to `argparse.ArgumentParser()`. Ignored</span>
<span class="sd">            if `parser` is not None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ArgumentTypeError: Error parsing command line arguments.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">parser</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;formatter_class&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parser_args</span><span class="p">:</span>
            <span class="n">parser_args</span><span class="p">[</span><span class="s2">&quot;formatter_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CorgyHelpFormatter</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">ArgumentParser</span><span class="p">(</span><span class="o">**</span><span class="n">parser_args</span><span class="p">)</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">add_args_to_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="n">defaults</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">())</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">try_cast</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="corgy._corgy.Corgy.parse_from_toml" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">parse_from_toml</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#corgy._corgy.Corgy.parse_from_toml" class="headerlink" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">parse_from_toml</span><span class="p">(</span><span class="n">toml_file</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Parse an object of the class from a toml file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>toml_file</code></td>
          <td>
                <code><span title="typing.IO">IO</span>[bytes]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A file-like object containing the class attributes in toml.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>defaults</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="typing.Mapping">Mapping</span>[str, <span title="typing.Any">Any</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary of default values, overriding any values specified
in the class.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TOMLDecodeError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Error parsing the toml file.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class G(Corgy):
...     x: int
...     y: Sequence[int]

&gt;&gt;&gt; class A(Corgy):
...     x: str
...     g: G

&gt;&gt;&gt; from io import BytesIO
&gt;&gt;&gt; f = BytesIO(b&#39;&#39;&#39;
...     x = &#39;one&#39;
...     [g]
...     x = 1
...     y = [1, 2, 3]
... &#39;&#39;&#39;)

&gt;&gt;&gt; A.parse_from_toml(f)  # doctest: +SKIP
A(x=&#39;one&#39;, g=G(x=1, y=[1, 2, 3]))
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>corgy/_corgy.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">parse_from_toml</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">_T</span><span class="p">],</span>
    <span class="n">toml_file</span><span class="p">:</span> <span class="n">IO</span><span class="p">[</span><span class="nb">bytes</span><span class="p">],</span>
    <span class="n">defaults</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_T</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse an object of the class from a toml file.</span>

<span class="sd">    Args:</span>
<span class="sd">        toml_file: A file-like object containing the class attributes in toml.</span>
<span class="sd">        defaults: A dictionary of default values, overriding any values specified</span>
<span class="sd">            in the class.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TOMLDecodeError: Error parsing the toml file.</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; class G(Corgy):</span>
<span class="sd">        ...     x: int</span>
<span class="sd">        ...     y: Sequence[int]</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: str</span>
<span class="sd">        ...     g: G</span>

<span class="sd">        &gt;&gt;&gt; from io import BytesIO</span>
<span class="sd">        &gt;&gt;&gt; f = BytesIO(b&#39;&#39;&#39;</span>
<span class="sd">        ...     x = &#39;one&#39;</span>
<span class="sd">        ...     [g]</span>
<span class="sd">        ...     x = 1</span>
<span class="sd">        ...     y = [1, 2, 3]</span>
<span class="sd">        ... &#39;&#39;&#39;)</span>

<span class="sd">        &gt;&gt;&gt; A.parse_from_toml(f)  # doctest: +SKIP</span>
<span class="sd">        A(x=&#39;one&#39;, g=G(x=1, y=[1, 2, 3]))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tomli</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="s2">&quot;tomllib&quot;</span> <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;tomli&quot;</span><span class="p">)</span>
    <span class="n">toml_data</span> <span class="o">=</span> <span class="n">tomli</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">toml_file</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">defaults</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">_k</span><span class="p">,</span> <span class="n">_v</span> <span class="ow">in</span> <span class="n">defaults</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">_k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">toml_data</span><span class="p">:</span>
                <span class="n">toml_data</span><span class="p">[</span><span class="n">_k</span><span class="p">]</span> <span class="o">=</span> <span class="n">_v</span>
    <span class="n">_parsers</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s2">&quot;__parsers&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_k</span><span class="p">,</span> <span class="n">_v</span> <span class="ow">in</span> <span class="n">toml_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">_k</span> <span class="ow">in</span> <span class="n">_parsers</span><span class="p">:</span>
            <span class="n">toml_data</span><span class="p">[</span><span class="n">_k</span><span class="p">]</span> <span class="o">=</span> <span class="n">_parsers</span><span class="p">[</span><span class="n">_k</span><span class="p">](</span><span class="n">_v</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">toml_data</span><span class="p">,</span> <span class="n">try_cast</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="corgy.corgyparser" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">corgy.corgyparser</span>


<a href="#corgy.corgyparser" class="headerlink" title="Permanent link">#</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">corgy</span><span class="o">.</span><span class="n">corgyparser</span><span class="p">(</span><span class="o">*</span><span class="n">var_names</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents first">
  
      <p>Decorate a function as a custom parser for one or more attributes.</p>
<p>To use a custom function for parsing a <code>Corgy</code> attribute, use this decorator.
Parsing functions must be static, and should only accept a single argument.
Decorating the function with <code>@staticmethod</code> is optional, but prevents type errors.
<code>@corgyparser</code> must be the final decorator in the decorator chain.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>var_names</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The attributes associated with the decorated parser.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>metavar</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword only argument to set the metavar when adding the associated
attribute(s) to an <code>ArgumentParser</code> instance.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>nargs</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[None, <span title="typing_extensions.Literal">Literal</span>[&#39;*&#39;, &#39;+&#39;], int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword only argument to set the number of arguments to be used for the
associated attribute(s). Must be <code>None</code>, <code>'*'</code>, <code>'+'</code>, or a positive number.
This value is passed as the <code>nargs</code> argument to
<code>ArgumentParser.add_argument</code>, and controls the number of arguments that
will be read from the command line, and passed to the parsing function.
For all values other than <code>None</code>, the parsing function will receive a list
of strings.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; import argparse
&gt;&gt;&gt; from argparse import ArgumentParser
&gt;&gt;&gt; from typing import Tuple
&gt;&gt;&gt; from corgy import Corgy, CorgyHelpFormatter, corgyparser

&gt;&gt;&gt; class A(Corgy):
...     time: Tuple[int, int, int]
...     @corgyparser(&quot;time&quot;, metavar=&quot;int:int:int&quot;)
...     @staticmethod
...     def parse_time(s):
...         return tuple(map(int, s.split(&quot;:&quot;)))

&gt;&gt;&gt; parser = ArgumentParser(
...     formatter_class=CorgyHelpFormatter,
...     add_help=False,
...     usage=argparse.SUPPRESS,
... )

&gt;&gt;&gt; A.add_args_to_parser(parser)
&gt;&gt;&gt; parser.parse_args([&quot;--time&quot;, &quot;1:2:3&quot;])
Namespace(time=(1, 2, 3))
</code></pre></div>
<p>Multiple arguments can be passed to the decorator, and will all be associated with
the same parser::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: int
...     y: int
...     @corgyparser(&quot;x&quot;, &quot;y&quot;)
...     @staticmethod
...     def parse_x_y(s):
...         return int(s)
</code></pre></div>
<p>The <code>@corgyparser</code> decorator can also be chained to use the same parser for multiple
arguments::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: int
...     y: int
...     @corgyparser(&quot;x&quot;)
...     @corgyparser(&quot;y&quot;)
...     @staticmethod
...     def parse_x_y(s):
...         return int(s)
</code></pre></div>
<p>Note: when chaining, the outer-most non-<code>None</code> value of <code>metavar</code> will be used.</p>
<p>Custom parsers can control the number of arguments they receive, independent of the
argument type::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; class A(Corgy):
...     x: int
...     @corgyparser(&quot;x&quot;, nargs=3)
...     @staticmethod
...     def parse_x(s):
...         # `s` will be a list of 3 strings.
...         return sum(map(int, s))

&gt;&gt;&gt; parser = ArgumentParser(
...     formatter_class=CorgyHelpFormatter,
...     add_help=False,
...     usage=argparse.SUPPRESS,
... )

&gt;&gt;&gt; A.add_args_to_parser(parser)
&gt;&gt;&gt; parser.parse_args([&quot;--x&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;])
Namespace(x=6)
</code></pre></div>
<p>When chaining, <code>nargs</code> must be the same for all decorators, otherwise <code>TypeError</code> is
raised.</p>

      <details class="quote">
        <summary>Source code in <code>corgy/_corgyparser.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">corgyparser</span><span class="p">(</span>
    <span class="o">*</span><span class="n">var_names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">metavar</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">nargs</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">],</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Any</span><span class="p">],</span> <span class="n">CorgyParser</span><span class="p">]],</span> <span class="n">CorgyParser</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorate a function as a custom parser for one or more attributes.</span>

<span class="sd">    To use a custom function for parsing a `Corgy` attribute, use this decorator.</span>
<span class="sd">    Parsing functions must be static, and should only accept a single argument.</span>
<span class="sd">    Decorating the function with `@staticmethod` is optional, but prevents type errors.</span>
<span class="sd">    `@corgyparser` must be the final decorator in the decorator chain.</span>

<span class="sd">    Args:</span>
<span class="sd">        var_names: The attributes associated with the decorated parser.</span>
<span class="sd">        metavar: Keyword only argument to set the metavar when adding the associated</span>
<span class="sd">            attribute(s) to an `ArgumentParser` instance.</span>
<span class="sd">        nargs: Keyword only argument to set the number of arguments to be used for the</span>
<span class="sd">            associated attribute(s). Must be `None`, `&#39;*&#39;`, `&#39;+&#39;`, or a positive number.</span>
<span class="sd">            This value is passed as the `nargs` argument to</span>
<span class="sd">            `ArgumentParser.add_argument`, and controls the number of arguments that</span>
<span class="sd">            will be read from the command line, and passed to the parsing function.</span>
<span class="sd">            For all values other than `None`, the parsing function will receive a list</span>
<span class="sd">            of strings.</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; import argparse</span>
<span class="sd">        &gt;&gt;&gt; from argparse import ArgumentParser</span>
<span class="sd">        &gt;&gt;&gt; from typing import Tuple</span>
<span class="sd">        &gt;&gt;&gt; from corgy import Corgy, CorgyHelpFormatter, corgyparser</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     time: Tuple[int, int, int]</span>
<span class="sd">        ...     @corgyparser(&quot;time&quot;, metavar=&quot;int:int:int&quot;)</span>
<span class="sd">        ...     @staticmethod</span>
<span class="sd">        ...     def parse_time(s):</span>
<span class="sd">        ...         return tuple(map(int, s.split(&quot;:&quot;)))</span>

<span class="sd">        &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">        ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">        ...     add_help=False,</span>
<span class="sd">        ...     usage=argparse.SUPPRESS,</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">        &gt;&gt;&gt; parser.parse_args([&quot;--time&quot;, &quot;1:2:3&quot;])</span>
<span class="sd">        Namespace(time=(1, 2, 3))</span>

<span class="sd">    Multiple arguments can be passed to the decorator, and will all be associated with</span>
<span class="sd">    the same parser::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: int</span>
<span class="sd">        ...     y: int</span>
<span class="sd">        ...     @corgyparser(&quot;x&quot;, &quot;y&quot;)</span>
<span class="sd">        ...     @staticmethod</span>
<span class="sd">        ...     def parse_x_y(s):</span>
<span class="sd">        ...         return int(s)</span>

<span class="sd">    The `@corgyparser` decorator can also be chained to use the same parser for multiple</span>
<span class="sd">    arguments::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: int</span>
<span class="sd">        ...     y: int</span>
<span class="sd">        ...     @corgyparser(&quot;x&quot;)</span>
<span class="sd">        ...     @corgyparser(&quot;y&quot;)</span>
<span class="sd">        ...     @staticmethod</span>
<span class="sd">        ...     def parse_x_y(s):</span>
<span class="sd">        ...         return int(s)</span>

<span class="sd">    Note: when chaining, the outer-most non-`None` value of `metavar` will be used.</span>

<span class="sd">    Custom parsers can control the number of arguments they receive, independent of the</span>
<span class="sd">    argument type::</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: int</span>
<span class="sd">        ...     @corgyparser(&quot;x&quot;, nargs=3)</span>
<span class="sd">        ...     @staticmethod</span>
<span class="sd">        ...     def parse_x(s):</span>
<span class="sd">        ...         # `s` will be a list of 3 strings.</span>
<span class="sd">        ...         return sum(map(int, s))</span>

<span class="sd">        &gt;&gt;&gt; parser = ArgumentParser(</span>
<span class="sd">        ...     formatter_class=CorgyHelpFormatter,</span>
<span class="sd">        ...     add_help=False,</span>
<span class="sd">        ...     usage=argparse.SUPPRESS,</span>
<span class="sd">        ... )</span>

<span class="sd">        &gt;&gt;&gt; A.add_args_to_parser(parser)</span>
<span class="sd">        &gt;&gt;&gt; parser.parse_args([&quot;--x&quot;, &quot;1&quot;, &quot;2&quot;, &quot;3&quot;])</span>
<span class="sd">        Namespace(x=6)</span>

<span class="sd">    When chaining, `nargs` must be the same for all decorators, otherwise `TypeError` is</span>
<span class="sd">    raised.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_var_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">_var_name</span> <span class="ow">in</span> <span class="n">var_names</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;corgyparser should be passed the name of arguments: decorate using&quot;</span>
            <span class="s2">&quot;@corgyparser(&lt;argument(s)&gt;)&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">var_names</span><span class="p">,</span> <span class="n">metavar</span><span class="p">,</span> <span class="n">fparse</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fparse</span><span class="p">,</span> <span class="n">CorgyParser</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">nargs</span> <span class="o">!=</span> <span class="n">fparse</span><span class="o">.</span><span class="n">nargs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;all `corgyparser` decorations of a funciton must have same `nargs`&quot;</span>
                <span class="p">)</span>
            <span class="n">corgy_parser</span> <span class="o">=</span> <span class="n">fparse</span>
            <span class="n">corgy_parser</span><span class="o">.</span><span class="n">var_names</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">var_names</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fparse</span><span class="p">,</span> <span class="nb">staticmethod</span><span class="p">):</span>
                <span class="n">fparse</span> <span class="o">=</span> <span class="n">fparse</span><span class="o">.</span><span class="vm">__func__</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">fparse</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;corgyparser can only decorate static functions&quot;</span><span class="p">)</span>
            <span class="n">corgy_parser</span> <span class="o">=</span> <span class="n">CorgyParser</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">var_names</span><span class="p">),</span> <span class="n">fparse</span><span class="p">,</span> <span class="n">nargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">metavar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">corgy_parser</span><span class="o">.</span><span class="n">fparse</span><span class="p">,</span> <span class="s2">&quot;__metavar__&quot;</span><span class="p">,</span> <span class="n">metavar</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">corgy_parser</span><span class="o">.</span><span class="n">fparse</span><span class="p">,</span> <span class="s2">&quot;__nargs__&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">corgy_parser</span>

    <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="n">wrapper</span><span class="p">,</span> <span class="n">var_names</span><span class="p">,</span> <span class="n">metavar</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="corgy.corgychecker" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">corgy.corgychecker</span>


<a href="#corgy.corgychecker" class="headerlink" title="Permanent link">#</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">corgy</span><span class="o">.</span><span class="n">corgychecker</span><span class="p">(</span><span class="o">*</span><span class="n">var_names</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents first">
  
      <p>Decorate a function as a custom checker for one or more attributes.</p>
<p>To use a custom function for checking the value of a <code>Corgy</code> attribute, use this
decorator. Checking functions must be static, and should only accept a single
argument, the value to be checked. They should raise <code>ValueError</code> to indicate value
mismatch. Decorating the function with <code>@staticmethod</code> is optional, but prevents
type errors. <code>@corgychecker</code> must be the final decorator in the decorator chain.</p>
<p>Custom checkers are called <em>after</em> type checking, so the values passed to them will
be of type corresponding to one of the assigned attributes.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>var_names</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The attributes associated with the decorated checker.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from corgy import Corgy, corgychecker

&gt;&gt;&gt; class A(Corgy):
...     x: int
...     @corgychecker(&quot;x&quot;)
...     @staticmethod
...     def check_x(val):
...         if val % 2:
...             raise ValueError(f&quot;&#39;{val}&#39; is not even&quot;)

&gt;&gt;&gt; a = A()
&gt;&gt;&gt; a.x = 2
&gt;&gt;&gt; a.x = 3
Traceback (most recent call last):
   ...
ValueError: error setting `x`: &#39;3&#39; is not even
</code></pre></div>
<p>Multiple attributes can use the same checker, either by chaining <code>corgychecker</code>, or
by passing all attribute names directly::</p>
<div class="highlight"><pre><span></span><code>&gt;&gt;&gt; from typing import Sequence

&gt;&gt;&gt; class A(Corgy):
...     x: int
...     y: float
...     z: str
...     w: Sequence[int]
...     @corgychecker(&quot;x&quot;)
...     @corgychecker(&quot;y&quot;)
...     def check_num(val):
...         if val &lt; 0:
...             raise ValueError(&quot;should be non-negative&quot;)
...     @corgychecker(&quot;z&quot;, &quot;w&quot;)
...     def check_seq(val):
...         if len(val) &gt; 10:
...             raise ValueError(&quot;too long&quot;)
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>corgy/_corgychecker.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">corgychecker</span><span class="p">(</span>
    <span class="o">*</span><span class="n">var_names</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Union</span><span class="p">[</span><span class="n">Callable</span><span class="p">,</span> <span class="n">CorgyChecker</span><span class="p">]],</span> <span class="n">CorgyChecker</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorate a function as a custom checker for one or more attributes.</span>

<span class="sd">    To use a custom function for checking the value of a `Corgy` attribute, use this</span>
<span class="sd">    decorator. Checking functions must be static, and should only accept a single</span>
<span class="sd">    argument, the value to be checked. They should raise `ValueError` to indicate value</span>
<span class="sd">    mismatch. Decorating the function with `@staticmethod` is optional, but prevents</span>
<span class="sd">    type errors. `@corgychecker` must be the final decorator in the decorator chain.</span>

<span class="sd">    Custom checkers are called _after_ type checking, so the values passed to them will</span>
<span class="sd">    be of type corresponding to one of the assigned attributes.</span>

<span class="sd">    Args:</span>
<span class="sd">        var_names: The attributes associated with the decorated checker.</span>

<span class="sd">    Example::</span>

<span class="sd">        &gt;&gt;&gt; from corgy import Corgy, corgychecker</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: int</span>
<span class="sd">        ...     @corgychecker(&quot;x&quot;)</span>
<span class="sd">        ...     @staticmethod</span>
<span class="sd">        ...     def check_x(val):</span>
<span class="sd">        ...         if val % 2:</span>
<span class="sd">        ...             raise ValueError(f&quot;&#39;{val}&#39; is not even&quot;)</span>

<span class="sd">        &gt;&gt;&gt; a = A()</span>
<span class="sd">        &gt;&gt;&gt; a.x = 2</span>
<span class="sd">        &gt;&gt;&gt; a.x = 3</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">           ...</span>
<span class="sd">        ValueError: error setting `x`: &#39;3&#39; is not even</span>

<span class="sd">    Multiple attributes can use the same checker, either by chaining `corgychecker`, or</span>
<span class="sd">    by passing all attribute names directly::</span>

<span class="sd">        &gt;&gt;&gt; from typing import Sequence</span>

<span class="sd">        &gt;&gt;&gt; class A(Corgy):</span>
<span class="sd">        ...     x: int</span>
<span class="sd">        ...     y: float</span>
<span class="sd">        ...     z: str</span>
<span class="sd">        ...     w: Sequence[int]</span>
<span class="sd">        ...     @corgychecker(&quot;x&quot;)</span>
<span class="sd">        ...     @corgychecker(&quot;y&quot;)</span>
<span class="sd">        ...     def check_num(val):</span>
<span class="sd">        ...         if val &lt; 0:</span>
<span class="sd">        ...             raise ValueError(&quot;should be non-negative&quot;)</span>
<span class="sd">        ...     @corgychecker(&quot;z&quot;, &quot;w&quot;)</span>
<span class="sd">        ...     def check_seq(val):</span>
<span class="sd">        ...         if len(val) &gt; 10:</span>
<span class="sd">        ...             raise ValueError(&quot;too long&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">_var_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">_var_name</span> <span class="ow">in</span> <span class="n">var_names</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;corgychecker should be passed the name of arguments: decorate using&quot;</span>
            <span class="s2">&quot;@corgychecker(&lt;argument(s)&gt;)&quot;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">var_names</span><span class="p">,</span> <span class="n">fcheck</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fcheck</span><span class="p">,</span> <span class="n">CorgyChecker</span><span class="p">):</span>
            <span class="n">corgy_checker</span> <span class="o">=</span> <span class="n">fcheck</span>
            <span class="n">corgy_checker</span><span class="o">.</span><span class="n">var_names</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">var_names</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fcheck</span><span class="p">,</span> <span class="nb">staticmethod</span><span class="p">):</span>
                <span class="n">fcheck</span> <span class="o">=</span> <span class="n">fcheck</span><span class="o">.</span><span class="vm">__func__</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">fcheck</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;corgychecker can only decorate static functions&quot;</span><span class="p">)</span>
            <span class="n">corgy_checker</span> <span class="o">=</span> <span class="n">CorgyChecker</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">var_names</span><span class="p">),</span> <span class="n">fcheck</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">corgy_checker</span>

    <span class="k">return</span> <span class="n">partial</span><span class="p">(</span><span class="n">wrapper</span><span class="p">,</span> <span class="n">var_names</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright (c) 2021-2023 Jayanth Koushik
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.expand"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>